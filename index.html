<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pet Arena - –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å –ø–∏—Ç–æ–º—Ü–µ–º</title>
    <style>
        :root {
            --primary: #7c3aed;
            --secondary: #a78bfa;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --dark: #1f2937;
            --light: #f8fafc;
            --background: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.8);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--background);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .game-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
        }
        
        .main-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .header {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(124, 58, 237, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .game-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #f59e0b, #ef4444, #7c3aed);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .score-display {
            text-align: center;
        }
        
        .score-label {
            color: #94a3b8;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .score-value {
            font-size: 2rem;
            font-weight: bold;
            color: #f59e0b;
            text-shadow: 0 0 10px rgba(245, 158, 11, 0.3);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            background: rgba(255,255,255,0.1);
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        .stat-icon {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .game-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .pet-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(124, 58, 237, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .pet-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .pet-avatar {
            font-size: 4rem;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .pet-info h3 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            color: #a78bfa;
        }
        
        .pet-level {
            color: #f59e0b;
            font-weight: bold;
        }
        
        .pet-attributes {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .attribute {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
        }
        
        .attribute-name {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: #cbd5e1;
        }
        
        .attribute-bar {
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .attribute-fill {
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .actions-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .action-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(124, 58, 237, 0.3);
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .action-emoji {
            font-size: 1.8rem;
        }
        
        .inventory-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(124, 58, 237, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .section-title {
            font-size: 1.5rem;
            color: #a78bfa;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .item-card {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .item-card:hover {
            transform: translateY(-5px);
            background: rgba(255,255,255,0.1);
        }
        
        .item-card.empty {
            opacity: 0.5;
            cursor: default;
        }
        
        .item-emoji {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        .item-name {
            font-size: 0.9rem;
            margin-bottom: 5px;
            color: #cbd5e1;
        }
        
        .item-quantity {
            font-size: 0.8rem;
            color: #94a3b8;
        }
        
        .item-effect {
            font-size: 0.7rem;
            color: #10b981;
            margin-top: 5px;
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .garden-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(16, 185, 129, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .garden-slots {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .garden-slot {
            aspect-ratio: 1;
            background: rgba(16, 185, 129, 0.1);
            border: 2px dashed rgba(16, 185, 129, 0.3);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .garden-slot:hover {
            background: rgba(16, 185, 129, 0.2);
            border-color: #10b981;
        }
        
        .garden-slot.planted {
            background: rgba(16, 185, 129, 0.2);
            border-style: solid;
        }
        
        .slot-emoji {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .slot-progress {
            width: 80%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .slot-progress-fill {
            height: 100%;
            background: #10b981;
            transition: width 0.3s ease;
        }
        
        .shop-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(245, 158, 11, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .shop-items {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .shop-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .shop-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }
        
        .shop-item-emoji {
            font-size: 1.8rem;
        }
        
        .shop-item-info {
            flex: 1;
        }
        
        .shop-item-name {
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .shop-item-effect {
            font-size: 0.8rem;
            color: #cbd5e1;
        }
        
        .shop-item-price {
            color: #f59e0b;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .buy-btn {
            background: linear-gradient(135deg, #f59e0b, #f97316);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .buy-btn:hover {
            transform: scale(1.05);
        }
        
        .buy-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .battle-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(239, 68, 68, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .battle-opponents {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
        }
        
        .opponent {
            text-align: center;
        }
        
        .opponent-avatar {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        .opponent-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .opponent-difficulty {
            font-size: 0.9rem;
            padding: 3px 10px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .difficulty-easy {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .difficulty-medium {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .difficulty-hard {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .vs {
            font-size: 2rem;
            color: #f59e0b;
            font-weight: bold;
        }
        
        .battle-rewards {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .reward-item {
            text-align: center;
        }
        
        .reward-emoji {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .events-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .events-list {
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .event-item {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 0.9rem;
            border-left: 3px solid;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .event-good { border-color: #10b981; }
        .event-bad { border-color: #ef4444; }
        .event-neutral { border-color: #94a3b8; }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid var(--primary);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        .modal-header {
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
            color: #a78bfa;
        }
        
        .case-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .case-item {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .case-item:hover {
            transform: scale(1.05);
            background: rgba(255,255,255,0.1);
        }
        
        .case-emoji {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .case-required {
            color: #f59e0b;
            font-size: 0.9rem;
        }
        
        .case-chance {
            color: #94a3b8;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card-bg);
            border-radius: 10px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideRight 0.3s ease;
            z-index: 1001;
            border-left: 4px solid;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        
        @keyframes slideRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .notification-emoji {
            font-size: 1.5rem;
        }
        
        .time-display {
            text-align: center;
            margin-top: 20px;
            font-size: 1.2rem;
            color: #94a3b8;
        }
        
        .time-value {
            color: #a78bfa;
            font-weight: bold;
        }
        
        .mutations-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }
        
        .mutation-badge {
            background: rgba(124, 58, 237, 0.2);
            color: #a78bfa;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .progress-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-bg);
            padding: 15px 30px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 999;
            border: 1px solid rgba(124, 58, 237, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .progress-label {
            color: #94a3b8;
        }
        
        .progress-bar {
            width: 300px;
            height: 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #7c3aed, #a78bfa);
            transition: width 0.3s ease;
        }
        
        @media (max-width: 1200px) {
            .game-container {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .game-content {
                grid-template-columns: 1fr;
            }
            
            .actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <div class="main-area">
            <!-- –®–∞–ø–∫–∞ —Å –æ—á–∫–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º -->
            <div class="header">
                <div class="header-top">
                    <div class="game-title">üêâ Pet Arena</div>
                    <div class="score-display">
                        <div class="score-label">–û–ß–ö–ò</div>
                        <div class="score-value" id="score">0</div>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">‚è±Ô∏è</div>
                        <div class="stat-value" id="time">30:00</div>
                        <div class="stat-label">–í–†–ï–ú–Ø</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-value" id="coins">100</div>
                        <div class="stat-label">–ú–û–ù–ï–¢–´</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-value" id="level">1</div>
                        <div class="stat-label">–£–†–û–í–ï–ù–¨</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üß¨</div>
                        <div class="stat-value" id="mutations">0</div>
                        <div class="stat-label">–ú–£–¢–ê–¶–ò–ò</div>
                    </div>
                </div>
            </div>
            
            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="game-content">
                <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –ø–∏—Ç–æ–º–µ—Ü -->
                <div class="pet-section">
                    <div class="pet-header">
                        <div class="pet-avatar" id="pet-avatar">üê≤</div>
                        <div class="pet-info">
                            <h3 id="pet-name">–î—Ä–∞–∫–æ—à–∞</h3>
                            <div class="pet-level">–£—Ä–æ–≤–µ–Ω—å <span id="pet-level">1</span></div>
                            <div class="mutations-list" id="mutations-list"></div>
                        </div>
                    </div>
                    
                    <div class="pet-attributes">
                        <div class="attribute">
                            <div class="attribute-name">
                                <span>‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ</span>
                                <span id="health-value">100</span>
                            </div>
                            <div class="attribute-bar">
                                <div class="attribute-fill" id="health-bar" style="width: 100%; background: linear-gradient(90deg, #ef4444, #f87171);"></div>
                            </div>
                        </div>
                        <div class="attribute">
                            <div class="attribute-name">
                                <span>üçñ –ì–æ–ª–æ–¥</span>
                                <span id="hunger-value">50</span>
                            </div>
                            <div class="attribute-bar">
                                <div class="attribute-fill" id="hunger-bar" style="width: 50%; background: linear-gradient(90deg, #f59e0b, #fbbf24);"></div>
                            </div>
                        </div>
                        <div class="attribute">
                            <div class="attribute-name">
                                <span>‚ö° –≠–Ω–µ—Ä–≥–∏—è</span>
                                <span id="energy-value">80</span>
                            </div>
                            <div class="attribute-bar">
                                <div class="attribute-fill" id="energy-bar" style="width: 80%; background: linear-gradient(90deg, #3b82f6, #60a5fa);"></div>
                            </div>
                        </div>
                        <div class="attribute">
                            <div class="attribute-name">
                                <span>üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</span>
                                <span id="mood-value">70</span>
                            </div>
                            <div class="attribute-bar">
                                <div class="attribute-fill" id="mood-bar" style="width: 70%; background: linear-gradient(90deg, #8b5cf6, #a78bfa);"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="actions-grid">
                        <button class="action-btn" onclick="feedPet()" id="feed-btn">
                            <div class="action-emoji">üçé</div>
                            <div>–ü–æ–∫–æ—Ä–º–∏—Ç—å</div>
                        </button>
                        <button class="action-btn" onclick="playWithPet()" id="play-btn">
                            <div class="action-emoji">üéÆ</div>
                            <div>–ü–æ–∏–≥—Ä–∞—Ç—å</div>
                        </button>
                        <button class="action-btn" onclick="restPet()" id="rest-btn">
                            <div class="action-emoji">üí§</div>
                            <div>–û—Ç–¥–æ—Ö–Ω—É—Ç—å</div>
                        </button>
                        <button class="action-btn" onclick="trainPet()" id="train-btn">
                            <div class="action-emoji">üèãÔ∏è</div>
                            <div>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å</div>
                        </button>
                        <button class="action-btn" onclick="mutatePet()" id="mutate-btn">
                            <div class="action-emoji">üß¨</div>
                            <div>–ú—É—Ç–∏—Ä–æ–≤–∞—Ç—å</div>
                        </button>
                        <button class="action-btn" onclick="useBoostItem()" id="boost-btn">
                            <div class="action-emoji">‚ö°</div>
                            <div>–ë—É—Å—Ç</div>
                        </button>
                    </div>
                </div>
                
                <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
                <div class="inventory-section">
                    <h3 class="section-title">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
                    <div class="inventory-grid" id="inventory-items">
                        <!-- –ü—Ä–µ–¥–º–µ—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar">
            <!-- –°–∞–¥ -->
            <div class="garden-section">
                <h3 class="section-title">üå± –°–∞–¥</h3>
                <div class="garden-slots" id="garden-slots">
                    <!-- –°–ª–æ—Ç—ã —Å–∞–¥–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                <button class="buy-btn" onclick="plantSeed()" style="width: 100%;" id="plant-btn">
                    –ü–æ—Å–∞–¥–∏—Ç—å —Å–µ–º–µ–Ω–∞ (10 –º–æ–Ω–µ—Ç)
                </button>
            </div>
            
            <!-- –ú–∞–≥–∞–∑–∏–Ω -->
            <div class="shop-section">
                <h3 class="section-title">üè™ –ú–∞–≥–∞–∑–∏–Ω</h3>
                <div class="shop-items" id="shop-items">
                    <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <!-- –ë–æ–∏ -->
            <div class="battle-section">
                <h3 class="section-title">‚öîÔ∏è –ê—Ä–µ–Ω–∞</h3>
                <div class="battle-opponents">
                    <div class="opponent">
                        <div class="opponent-avatar" id="player-battle-avatar">üê≤</div>
                        <div class="opponent-name" id="player-battle-name">–î—Ä–∞–∫–æ—à–∞</div>
                        <div class="opponent-difficulty difficulty-easy">–£—Ä–æ–≤–µ–Ω—å 1</div>
                    </div>
                    <div class="vs">VS</div>
                    <div class="opponent">
                        <div class="opponent-avatar" id="enemy-avatar">ü§ñ</div>
                        <div class="opponent-name" id="enemy-name">–°–ª–∞–π–º</div>
                        <div class="opponent-difficulty difficulty-easy" id="enemy-difficulty">–õ–µ–≥–∫–∏–π</div>
                    </div>
                </div>
                
                <div class="battle-rewards">
                    <div class="reward-item">
                        <div class="reward-emoji">üí∞</div>
                        <div id="reward-coins">10-20</div>
                    </div>
                    <div class="reward-item">
                        <div class="reward-emoji">üéÅ</div>
                        <div id="reward-chance">30%</div>
                    </div>
                    <div class="reward-item">
                        <div class="reward-emoji">üîë</div>
                        <div id="reward-key">10%</div>
                    </div>
                </div>
                
                <button class="buy-btn" onclick="startBattle()" style="width: 100%; background: linear-gradient(135deg, #ef4444, #f87171);" id="battle-btn">
                    –ù–∞—á–∞—Ç—å –±–æ–π
                </button>
            </div>
            
            <!-- –°–æ–±—ã—Ç–∏—è -->
            <div class="events-section">
                <h3 class="section-title">üé≤ –°–æ–±—ã—Ç–∏—è</h3>
                <div class="events-list" id="events-list">
                    <!-- –°–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <!-- –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã -->
            <div class="time-display">
                –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —á–µ—Ä–µ–∑: <span class="time-value" id="game-timer">30:00</span>
            </div>
        </div>
    </div>
    
    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä -->
    <div class="progress-container">
        <div class="progress-label">–ü—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã:</div>
        <div class="progress-bar">
            <div class="progress-fill" id="game-progress" style="width: 0%;"></div>
        </div>
        <div class="time-value" id="progress-percent">0%</div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–µ–π—Å–æ–≤ -->
    <div class="modal" id="cases-modal" style="display: none;">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal('cases-modal')">√ó</button>
            <h2 class="modal-header">üéÅ –ö–µ–π—Å—ã</h2>
            <div style="text-align: center; margin-bottom: 20px; color: #cbd5e1;">
                –í—ã–±–µ—Ä–∏—Ç–µ –∫–µ–π—Å –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è
            </div>
            
            <div class="case-grid">
                <div class="case-item" onclick="openCase('common')">
                    <div class="case-emoji">üì¶</div>
                    <div style="font-weight: bold; margin-bottom: 5px;">–û–±—ã—á–Ω—ã–π –∫–µ–π—Å</div>
                    <div class="case-required">–ù—É–∂–µ–Ω: –û–±—ã—á–Ω—ã–π –∫–ª—é—á</div>
                    <div class="case-chance">–®–∞–Ω—Å –Ω–∞ —Ä–µ–¥–∫–æ–µ: 20%</div>
                </div>
                <div class="case-item" onclick="openCase('rare')">
                    <div class="case-emoji">üéÅ</div>
                    <div style="font-weight: bold; margin-bottom: 5px;">–†–µ–¥–∫–∏–π –∫–µ–π—Å</div>
                    <div class="case-required">–ù—É–∂–µ–Ω: –†–µ–¥–∫–∏–π –∫–ª—é—á</div>
                    <div class="case-chance">–®–∞–Ω—Å –Ω–∞ —ç–ø–∏—á–µ—Å–∫–æ–µ: 40%</div>
                </div>
                <div class="case-item" onclick="openCase('epic')">
                    <div class="case-emoji">üíé</div>
                    <div style="font-weight: bold; margin-bottom: 5px;">–≠–ø–∏—á–µ—Å–∫–∏–π –∫–µ–π—Å</div>
                    <div class="case-required">–ù—É–∂–µ–Ω: –≠–ø–∏—á–µ—Å–∫–∏–π –∫–ª—é—á</div>
                    <div class="case-chance">–®–∞–Ω—Å –Ω–∞ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ: 60%</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        let game = {
            time: 30 * 60, // 30 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            score: 0,
            coins: 100,
            level: 1,
            exp: 0,
            expNeeded: 100,
            mutations: [],
            keys: { common: 0, rare: 0, epic: 0 },
            
            pet: {
                name: "–î—Ä–∞–∫–æ—à–∞",
                avatar: "üê≤",
                level: 1,
                health: 100,
                maxHealth: 100,
                hunger: 50,
                energy: 80,
                mood: 70,
                attack: 15,
                defense: 8,
                speed: 12,
                boost: { active: false, expires: 0, multiplier: 1 }
            },
            
            garden: {
                slots: Array(4).fill(null).map(() => ({ plant: null, plantedAt: 0, growth: 0 })),
                plants: [
                    { name: "–ú–æ—Ä–∫–æ–≤—å", emoji: "ü•ï", growTime: 120, yield: { food: 2 } },
                    { name: "–Ø–±–ª–æ–Ω—è", emoji: "üçé", growTime: 180, yield: { food: 3, mood: 10 } },
                    { name: "–ó–æ–ª–æ—Ç–æ–µ –¥–µ—Ä–µ–≤–æ", emoji: "üåü", growTime: 300, yield: { coins: 10, food: 1 } }
                ]
            },
            
            inventory: [
                { id: 1, name: "–ú–æ—Ä–∫–æ–≤—å", emoji: "ü•ï", type: "food", quantity: 5, effect: { hunger: 30 } },
                { id: 2, name: "–Ø–±–ª–æ–∫–æ", emoji: "üçé", type: "food", quantity: 3, effect: { hunger: 50, mood: 10 } },
                { id: 3, name: "–°–µ–º–µ–Ω–∞", emoji: "üå±", type: "seed", quantity: 3, effect: { plant: "–ú–æ—Ä–∫–æ–≤—å" } },
                { id: 4, name: "–û–±—ã—á–Ω—ã–π –∫–ª—é—á", emoji: "üîë", type: "key", quantity: 1, rarity: "common" }
            ],
            
            shop: [
                { id: 1, name: "–ú–æ—Ä–∫–æ–≤—å", emoji: "ü•ï", price: 5, effect: "–ì–æ–ª–æ–¥ +30", type: "food", stats: { hunger: 30 } },
                { id: 2, name: "–Ø–±–ª–æ–∫–æ", emoji: "üçé", price: 10, effect: "–ì–æ–ª–æ–¥ +50, –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ +10", type: "food", stats: { hunger: 50, mood: 10 } },
                { id: 3, name: "–°–µ–º–µ–Ω–∞", emoji: "üå±", price: 10, effect: "–î–ª—è –ø–æ—Å–∞–¥–∫–∏", type: "seed" },
                { id: 4, name: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫", emoji: "ü•§", price: 20, effect: "–≠–Ω–µ—Ä–≥–∏—è +40", type: "boost", stats: { energy: 40 } },
                { id: 5, name: "–ë—É—Å—Ç –∞—Ç–∞–∫–∏", emoji: "‚öîÔ∏è", price: 50, effect: "–ê—Ç–∞–∫–∞ x2 –Ω–∞ 1 –º–∏–Ω", type: "boost", stats: { attack: 2, duration: 60 } },
                { id: 6, name: "–õ–µ—á–µ–±–Ω–æ–µ –∑–µ–ª—å–µ", emoji: "üß™", price: 30, effect: "–ó–¥–æ—Ä–æ–≤—å–µ +50", type: "heal", stats: { health: 50 } }
            ],
            
            mutationsList: [
                { 
                    id: 1, 
                    name: "–û–≥–Ω–µ–Ω–Ω–∞—è —á–µ—à—É—è", 
                    emoji: "üî•", 
                    type: "positive",
                    effect: "–ê—Ç–∞–∫–∞ +25%, –ó–∞—â–∏—Ç–∞ +15%",
                    stats: { attack: 0.25, defense: 0.15, score: 50 }
                },
                { 
                    id: 2, 
                    name: "–õ–µ–¥—è–Ω–æ–π –≤–∑–≥–ª—è–¥", 
                    emoji: "‚ùÑÔ∏è", 
                    type: "positive",
                    effect: "–ê—Ç–∞–∫–∞ +20%, –°–∫–æ—Ä–æ—Å—Ç—å +30%",
                    stats: { attack: 0.20, speed: 0.30, score: 50 }
                },
                { 
                    id: 3, 
                    name: "–ö–æ–ª—é—á–∞—è –±—Ä–æ–Ω—è", 
                    emoji: "ü¶î", 
                    type: "positive",
                    effect: "–ó–∞—â–∏—Ç–∞ +40%",
                    stats: { defense: 0.40, score: 40 }
                },
                { 
                    id: 4, 
                    name: "–ë—ã—Å—Ç—Ä—ã–µ –ª–∞–ø—ã", 
                    emoji: "‚ö°", 
                    type: "positive",
                    effect: "–°–∫–æ—Ä–æ—Å—Ç—å +50%",
                    stats: { speed: 0.50, score: 40 }
                },
                { 
                    id: 5, 
                    name: "–§–µ—Ä–º–µ—Ä", 
                    emoji: "üë®‚Äçüåæ", 
                    type: "positive",
                    effect: "–£—Ä–æ–∂–∞–π–Ω–æ—Å—Ç—å +100%",
                    stats: { harvest: 2.0, score: 30 }
                },
                { 
                    id: 6, 
                    name: "–£–¥–∞—á–ª–∏–≤—ã–π", 
                    emoji: "üçÄ", 
                    type: "positive",
                    effect: "–®–∞–Ω—Å –¥—Ä–æ–ø–∞ +25%",
                    stats: { dropChance: 0.25, score: 35 }
                }
            ],
            
            enemies: [
                { 
                    name: "–°–ª–∞–π–º", avatar: "üü¢", difficulty: "easy", 
                    health: 50, attack: 8, defense: 3,
                    reward: { coins: [10, 20], exp: 10, dropChance: 0.3, keyChance: 0.1, score: 10 }
                },
                { 
                    name: "–ì–æ–±–ª–∏–Ω", avatar: "üë∫", difficulty: "easy", 
                    health: 60, attack: 10, defense: 5,
                    reward: { coins: [15, 25], exp: 15, dropChance: 0.4, keyChance: 0.15, score: 15 }
                },
                { 
                    name: "–ñ–µ–ª–µ–∑–Ω—ã–π —Å—Ç—Ä–∞–∂", avatar: "ü§ñ", difficulty: "medium", 
                    health: 80, attack: 12, defense: 10,
                    reward: { coins: [25, 40], exp: 25, dropChance: 0.5, keyChance: 0.2, score: 25 }
                },
                { 
                    name: "–û–≥–Ω–µ–Ω–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", avatar: "üêâ", difficulty: "medium", 
                    health: 100, attack: 15, defense: 8,
                    reward: { coins: [35, 55], exp: 35, dropChance: 0.6, keyChance: 0.25, score: 35 }
                },
                { 
                    name: "–î—Ä–µ–≤–Ω–∏–π –≥–æ–ª–µ–º", avatar: "üóø", difficulty: "hard", 
                    health: 120, attack: 18, defense: 15,
                    reward: { coins: [50, 80], exp: 50, dropChance: 0.7, keyChance: 0.3, score: 50 }
                }
            ],
            
            cases: {
                common: {
                    emoji: "üì¶",
                    requiredKey: "common",
                    rewards: [
                        { type: "food", name: "–ú–æ—Ä–∫–æ–≤—å", emoji: "ü•ï", quantity: 3, chance: 0.5 },
                        { type: "food", name: "–Ø–±–ª–æ–∫–æ", emoji: "üçé", quantity: 2, chance: 0.3 },
                        { type: "boost", name: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫", emoji: "ü•§", quantity: 1, chance: 0.15 },
                        { type: "key", name: "–†–µ–¥–∫–∏–π –∫–ª—é—á", emoji: "üîë", quantity: 1, chance: 0.05 }
                    ]
                },
                rare: {
                    emoji: "üéÅ",
                    requiredKey: "rare",
                    rewards: [
                        { type: "food", name: "–Ø–±–ª–æ–∫–æ", emoji: "üçé", quantity: 5, chance: 0.4 },
                        { type: "boost", name: "–ë—É—Å—Ç –∞—Ç–∞–∫–∏", emoji: "‚öîÔ∏è", quantity: 1, chance: 0.3 },
                        { type: "heal", name: "–õ–µ—á–µ–±–Ω–æ–µ –∑–µ–ª—å–µ", emoji: "üß™", quantity: 2, chance: 0.2 },
                        { type: "key", name: "–≠–ø–∏—á–µ—Å–∫–∏–π –∫–ª—é—á", emoji: "üíé", quantity: 1, chance: 0.1 }
                    ]
                },
                epic: {
                    emoji: "üíé",
                    requiredKey: "epic",
                    rewards: [
                        { type: "boost", name: "–ë—É—Å—Ç –∞—Ç–∞–∫–∏", emoji: "‚öîÔ∏è", quantity: 3, chance: 0.3 },
                        { type: "heal", name: "–õ–µ—á–µ–±–Ω–æ–µ –∑–µ–ª—å–µ", emoji: "üß™", quantity: 5, chance: 0.3 },
                        { type: "special", name: "–ó–æ–ª–æ—Ç–æ–µ —è–±–ª–æ–∫–æ", emoji: "üåü", quantity: 2, chance: 0.2 },
                        { type: "mutation", name: "–°–ª—É—á–∞–π–Ω–∞—è –º—É—Ç–∞—Ü–∏—è", emoji: "üß¨", quantity: 1, chance: 0.2 }
                    ]
                }
            },
            
            events: []
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            updateDisplay();
            startGameTimer();
            updateGarden();
            updateShop();
            updateInventory();
            updateBattleScreen();
            
            // –°–ª—É—á–∞–π–Ω–æ–µ –∏–º—è –∏ –∞–≤–∞—Ç–∞—Ä
            const names = ["–î—Ä–∞–∫–æ—à–∞", "–û–≥–Ω–µ–≥—Ä–∏–≤", "–ò—Å–∫–æ—Ä–∫–∞", "–ó–º–µ—é–∫–∞", "–ü—É—à–∏—Å—Ç–∏–∫", "–ì—Ä–æ–∑–æ–≤–∏–∫"];
            const avatars = ["üê≤", "üêâ", "ü¶é", "ü¶ñ", "üêä", "ü¶ï"];
            game.pet.name = names[Math.floor(Math.random() * names.length)];
            game.pet.avatar = avatars[Math.floor(Math.random() * avatars.length)];
            
            addEvent("üéÆ –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –£ –≤–∞—Å –µ—Å—Ç—å 30 –º–∏–Ω—É—Ç.", "neutral");
            
            // –°–æ–±—ã—Ç–∏—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            setInterval(() => {
                triggerRandomEvent();
            }, 60000);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–¥–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                updateGarden();
            }, 10000);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É—Å—Ç–æ–≤
            setInterval(() => {
                updateBoosts();
            }, 1000);
        }

        // –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã
        function startGameTimer() {
            setInterval(() => {
                game.time--;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
                const minutes = Math.floor(game.time / 60);
                const seconds = game.time % 60;
                const timeStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                document.getElementById('time').textContent = timeStr;
                document.getElementById('game-timer').textContent = timeStr;
                
                // –ü—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã
                const progress = 100 - (game.time / (30 * 60)) * 100;
                document.getElementById('game-progress').style.width = progress + '%';
                document.getElementById('progress-percent').textContent = Math.round(progress) + '%';
                
                // –ü–∞—Å—Å–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
                if (game.time % 30 === 0) {
                    updatePassiveStats();
                }
                
                // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
                if (game.time <= 0) {
                    endGame();
                }
            }, 1000);
        }

        // –ü–∞—Å—Å–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
        function updatePassiveStats() {
            game.pet.hunger = Math.max(0, game.pet.hunger - 2);
            game.pet.energy = Math.min(100, game.pet.energy + 1);
            game.pet.mood = Math.max(0, game.pet.mood - 1);
            
            if (game.pet.hunger < 20) {
                game.pet.health = Math.max(1, game.pet.health - 1);
            }
            
            updateDisplay();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å–ø–ª–µ—è
        function updateDisplay() {
            // –û—Å–Ω–æ–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            document.getElementById('score').textContent = game.score;
            document.getElementById('coins').textContent = game.coins;
            document.getElementById('level').textContent = game.level;
            document.getElementById('mutations').textContent = game.mutations.length;
            
            // –ü–∏—Ç–æ–º–µ—Ü
            document.getElementById('pet-avatar').textContent = game.pet.avatar;
            document.getElementById('pet-name').textContent = game.pet.name;
            document.getElementById('pet-level').textContent = game.pet.level;
            document.getElementById('player-battle-avatar').textContent = game.pet.avatar;
            document.getElementById('player-battle-name').textContent = game.pet.name;
            
            // –ê—Ç—Ä–∏–±—É—Ç—ã
            document.getElementById('health-value').textContent = Math.round(game.pet.health);
            document.getElementById('hunger-value').textContent = Math.round(game.pet.hunger);
            document.getElementById('energy-value').textContent = Math.round(game.pet.energy);
            document.getElementById('mood-value').textContent = Math.round(game.pet.mood);
            
            document.getElementById('health-bar').style.width = (game.pet.health / game.pet.maxHealth * 100) + '%';
            document.getElementById('hunger-bar').style.width = game.pet.hunger + '%';
            document.getElementById('energy-bar').style.width = game.pet.energy + '%';
            document.getElementById('mood-bar').style.width = game.pet.mood + '%';
            
            // –ú—É—Ç–∞—Ü–∏–∏
            updateMutationsList();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
            updateButtons();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º—É—Ç–∞—Ü–∏–π
        function updateMutationsList() {
            const list = document.getElementById('mutations-list');
            list.innerHTML = '';
            
            game.mutations.forEach(mutation => {
                const badge = document.createElement('div');
                badge.className = 'mutation-badge';
                badge.innerHTML = `${mutation.emoji} ${mutation.name}`;
                badge.title = mutation.effect;
                list.appendChild(badge);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
        function updateButtons() {
            // –ö–Ω–æ–ø–∫–∞ –∫–æ—Ä–º–ª–µ–Ω–∏—è
            const hasFood = game.inventory.some(item => item.type === 'food' && item.quantity > 0);
            document.getElementById('feed-btn').disabled = !hasFood || game.pet.hunger >= 100;
            
            // –ö–Ω–æ–ø–∫–∞ –∏–≥—Ä—ã
            document.getElementById('play-btn').disabled = game.pet.energy < 20;
            
            // –ö–Ω–æ–ø–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            document.getElementById('train-btn').disabled = game.pet.energy < 30;
            
            // –ö–Ω–æ–ø–∫–∞ –º—É—Ç–∞—Ü–∏–∏
            document.getElementById('mutate-btn').disabled = game.coins < 50 || game.mutations.length >= 6;
            
            // –ö–Ω–æ–ø–∫–∞ –±—É—Å—Ç–∞
            const hasBoost = game.inventory.some(item => item.type === 'boost' && item.quantity > 0);
            document.getElementById('boost-btn').disabled = !hasBoost || game.pet.boost.active;
            
            // –ö–Ω–æ–ø–∫–∞ –ø–æ—Å–∞–¥–∫–∏
            const hasSeeds = game.inventory.some(item => item.type === 'seed' && item.quantity > 0);
            const hasEmptySlot = game.garden.slots.some(slot => !slot.plant);
            document.getElementById('plant-btn').disabled = !hasSeeds || !hasEmptySlot || game.coins < 10;
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
        function addEvent(text, type = "neutral") {
            const event = { text, type, time: Date.now() };
            game.events.unshift(event);
            
            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–±—ã—Ç–∏–π
            if (game.events.length > 10) {
                game.events.pop();
            }
            
            updateEventsList();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification(text, type);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(text, type) {
            const colors = {
                good: "#10b981",
                bad: "#ef4444",
                neutral: "#3b82f6"
            };
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.borderLeftColor = colors[type] || colors.neutral;
            
            notification.innerHTML = `
                <div class="notification-emoji">${type === 'good' ? 'üéÅ' : type === 'bad' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}</div>
                <div>${text}</div>
            `;
            
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª–∏—Ç—å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ–±—ã—Ç–∏–π
        function updateEventsList() {
            const list = document.getElementById('events-list');
            list.innerHTML = '';
            
            game.events.forEach(event => {
                const item = document.createElement('div');
                item.className = `event-item event-${event.type}`;
                item.textContent = event.text;
                list.appendChild(item);
            });
        }

        // –°–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
        function triggerRandomEvent() {
            const events = [
                {
                    type: "good",
                    text: "üéÅ –í—ã –Ω–∞—à–ª–∏ —Å—É–Ω–¥—É–∫ —Å —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏! +25 –º–æ–Ω–µ—Ç",
                    action: () => {
                        game.coins += 25;
                        game.score += 25;
                        addEvent("–ù–∞–π–¥–µ–Ω–æ 25 –º–æ–Ω–µ—Ç!", "good");
                    }
                },
                {
                    type: "good",
                    text: "üçÄ –í–∞–º –ø–æ–≤–µ–∑–ª–æ! –ü–∏—Ç–æ–º–µ—Ü –Ω–∞—à—ë–ª –≤–∫—É—Å–Ω—É—é –µ–¥—É",
                    action: () => {
                        addToInventory({ name: "–í–∫—É—Å–Ω–∞—è –µ–¥–∞", emoji: "üçñ", type: "food", quantity: 2, effect: { hunger: 60, mood: 15 } });
                        game.score += 15;
                        addEvent("–ù–∞–π–¥–µ–Ω–∞ –≤–∫—É—Å–Ω–∞—è –µ–¥–∞ x2!", "good");
                    }
                },
                {
                    type: "good",
                    text: "üí´ –ü—Ä–æ–∏–∑–æ—à–ª–∞ —Å–ø–æ–Ω—Ç–∞–Ω–Ω–∞—è –º—É—Ç–∞—Ü–∏—è!",
                    action: () => {
                        addRandomMutation();
                        game.score += 30;
                    }
                },
                {
                    type: "bad",
                    text: "üí¢ –ü–∏—Ç–æ–º–µ—Ü –ø—Ä–æ—Å—Ç—É–¥–∏–ª—Å—è! -20 –∑–¥–æ—Ä–æ–≤—å—è",
                    action: () => {
                        game.pet.health = Math.max(1, game.pet.health - 20);
                        addEvent("–ü–∏—Ç–æ–º–µ—Ü –ø—Ä–æ—Å—Ç—É–¥–∏–ª—Å—è! -20 –∑–¥–æ—Ä–æ–≤—å—è", "bad");
                    }
                },
                {
                    type: "bad",
                    text: "üò¥ –ü–∏—Ç–æ–º–µ—Ü —Å–ª–∏—à–∫–æ–º —É—Å—Ç–∞–ª! -30 —ç–Ω–µ—Ä–≥–∏–∏",
                    action: () => {
                        game.pet.energy = Math.max(0, game.pet.energy - 30);
                        addEvent("–ü–∏—Ç–æ–º–µ—Ü —É—Å—Ç–∞–ª! -30 —ç–Ω–µ—Ä–≥–∏–∏", "bad");
                    }
                },
                {
                    type: "neutral",
                    text: "üåßÔ∏è –ü–æ—à—ë–ª –¥–æ–∂–¥—å. –ü–∏—Ç–æ–º–µ—Ü –∑–∞–≥—Ä—É—Å—Ç–∏–ª",
                    action: () => {
                        game.pet.mood = Math.max(0, game.pet.mood - 20);
                        addEvent("–î–æ–∂–¥—å –∏—Å–ø–æ—Ä—Ç–∏–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ! -20 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è", "neutral");
                    }
                },
                {
                    type: "good",
                    text: "‚òÄÔ∏è –°–æ–ª–Ω–µ—á–Ω—ã–π –¥–µ–Ω—å! –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —É–ª—É—á—à–∏–ª–æ—Å—å",
                    action: () => {
                        game.pet.mood = Math.min(100, game.pet.mood + 25);
                        addEvent("–°–æ–ª–Ω–µ—á–Ω—ã–π –¥–µ–Ω—å! +25 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è", "good");
                    }
                }
            ];
            
            const event = events[Math.floor(Math.random() * events.length)];
            event.action();
            updateDisplay();
        }

        // –î–µ–π—Å—Ç–≤–∏—è —Å –ø–∏—Ç–æ–º—Ü–µ–º
        function feedPet() {
            const food = game.inventory.find(item => item.type === 'food' && item.quantity > 0);
            if (!food) return;
            
            food.quantity--;
            if (food.quantity <= 0) {
                game.inventory = game.inventory.filter(i => i !== food);
            }
            
            const effect = food.effect || { hunger: 30 };
            game.pet.hunger = Math.min(100, game.pet.hunger + (effect.hunger || 0));
            game.pet.mood = Math.min(100, game.pet.mood + (effect.mood || 0));
            
            game.score += 5;
            addEvent(`üçé –ü–æ–∫–æ—Ä–º–∏–ª–∏ ${food.name}! –ì–æ–ª–æ–¥ +${effect.hunger || 30}`, "good");
            updateDisplay();
            updateInventory();
        }

        function playWithPet() {
            game.pet.energy = Math.max(0, game.pet.energy - 15);
            game.pet.mood = Math.min(100, game.pet.mood + 20);
            
            game.score += 8;
            addEvent("üéÆ –ü–æ–∏–≥—Ä–∞–ª–∏ —Å –ø–∏—Ç–æ–º—Ü–µ–º! –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ +20", "good");
            updateDisplay();
        }

        function restPet() {
            game.pet.energy = Math.min(100, game.pet.energy + 40);
            game.pet.hunger = Math.max(0, game.pet.hunger - 10);
            
            game.score += 6;
            addEvent("üí§ –ü–∏—Ç–æ–º–µ—Ü –æ—Ç–¥–æ—Ö–Ω—É–ª! –≠–Ω–µ—Ä–≥–∏—è +40", "good");
            updateDisplay();
        }

        function trainPet() {
            game.pet.energy = Math.max(0, game.pet.energy - 25);
            
            // –£–ª—É—á—à–µ–Ω–∏–µ —Å—Ç–∞—Ç–æ–≤
            if (Math.random() > 0.5) {
                game.pet.attack += Math.random() * 2 + 1;
                addEvent(`‚öîÔ∏è –ê—Ç–∞–∫–∞ —É–ª—É—á—à–µ–Ω–∞! –¢–µ–ø–µ—Ä—å: ${game.pet.attack.toFixed(1)}`, "good");
            } else {
                game.pet.defense += Math.random() * 1.5 + 0.5;
                addEvent(`üõ°Ô∏è –ó–∞—â–∏—Ç–∞ —É–ª—É—á—à–µ–Ω–∞! –¢–µ–ø–µ—Ä—å: ${game.pet.defense.toFixed(1)}`, "good");
            }
            
            game.exp += 15;
            game.score += 10;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω—è
            if (game.exp >= game.expNeeded) {
                game.level++;
                game.pet.level++;
                game.exp = 0;
                game.expNeeded = game.level * 150;
                game.pet.maxHealth += 25;
                game.pet.health = game.pet.maxHealth;
                game.score += 50;
                
                addEvent(`üéâ –£—Ä–æ–≤–µ–Ω—å ${game.level}! –ó–¥–æ—Ä–æ–≤—å–µ +25`, "good");
            }
            
            updateDisplay();
        }

        // –ú—É—Ç–∞—Ü–∏–∏
        function mutatePet() {
            if (game.coins < 50) return;
            
            game.coins -= 50;
            addRandomMutation();
            game.score += 30;
            addEvent("üß¨ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –º—É—Ç–∞—Ü–∏—è –∑–∞ 50 –º–æ–Ω–µ—Ç", "good");
            updateDisplay();
        }

        function addRandomMutation() {
            const available = game.mutationsList.filter(m => 
                !game.mutations.some(gm => gm.id === m.id)
            );
            
            if (available.length === 0) return;
            
            const mutation = available[Math.floor(Math.random() * available.length)];
            game.mutations.push(mutation);
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
            if (mutation.stats.attack) game.pet.attack *= (1 + mutation.stats.attack);
            if (mutation.stats.defense) game.pet.defense *= (1 + mutation.stats.defense);
            if (mutation.stats.speed) game.pet.speed *= (1 + mutation.stats.speed);
            if (mutation.stats.harvest) {
                // –ú–Ω–æ–∂–∏—Ç–µ–ª—å —É—Ä–æ–∂–∞—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–µ
            }
            
            game.score += mutation.stats.score || 0;
            addEvent(`üß¨ –ù–æ–≤–∞—è –º—É—Ç–∞—Ü–∏—è: ${mutation.emoji} ${mutation.name}`, "good");
            
            updateDisplay();
        }

        // –ë—É—Å—Ç—ã
        function useBoostItem() {
            const boost = game.inventory.find(item => item.type === 'boost' && item.quantity > 0);
            if (!boost) return;
            
            boost.quantity--;
            if (boost.quantity <= 0) {
                game.inventory = game.inventory.filter(i => i !== boost);
            }
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±—É—Å—Ç–∞
            if (boost.name === "–ë—É—Å—Ç –∞—Ç–∞–∫–∏") {
                game.pet.boost = {
                    active: true,
                    expires: Date.now() + 60000, // 1 –º–∏–Ω—É—Ç–∞
                    multiplier: 2
                };
                addEvent("‚öîÔ∏è –ë—É—Å—Ç –∞—Ç–∞–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –ê—Ç–∞–∫–∞ x2 –Ω–∞ 1 –º–∏–Ω—É—Ç—É", "good");
            } else if (boost.name === "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫") {
                game.pet.energy = Math.min(100, game.pet.energy + 40);
                addEvent("ü•§ –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫ –≤—ã–ø–∏—Ç! –≠–Ω–µ—Ä–≥–∏—è +40", "good");
            }
            
            game.score += 15;
            updateDisplay();
            updateInventory();
        }

        function updateBoosts() {
            if (game.pet.boost.active && Date.now() > game.pet.boost.expires) {
                game.pet.boost.active = false;
                addEvent("‚öîÔ∏è –ë—É—Å—Ç –∞—Ç–∞–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª—Å—è", "neutral");
                updateDisplay();
            }
        }

        // –°–∞–¥
        function updateGarden() {
            const now = Date.now();
            const slotsContainer = document.getElementById('garden-slots');
            slotsContainer.innerHTML = '';
            
            game.garden.slots.forEach((slot, index) => {
                const slotDiv = document.createElement('div');
                slotDiv.className = `garden-slot ${slot.plant ? 'planted' : ''}`;
                slotDiv.onclick = () => harvestSlot(index);
                
                if (slot.plant) {
                    const plant = game.garden.plants.find(p => p.name === slot.plant);
                    const timePassed = (now - slot.plantedAt) / 1000; // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
                    const growth = Math.min(100, (timePassed / plant.growTime) * 100);
                    
                    slot.growth = growth;
                    
                    slotDiv.innerHTML = `
                        <div class="slot-emoji">${plant.emoji}</div>
                        <div style="font-size: 0.9rem; margin-bottom: 10px;">${plant.name}</div>
                        <div class="slot-progress">
                            <div class="slot-progress-fill" style="width: ${growth}%;"></div>
                        </div>
                        <div style="font-size: 0.8rem; margin-top: 5px; color: #94a3b8;">
                            ${growth >= 100 ? '–ì–æ—Ç–æ–≤–æ!' : Math.round(growth) + '%'}
                        </div>
                    `;
                } else {
                    slotDiv.innerHTML = `
                        <div class="slot-emoji">üå´Ô∏è</div>
                        <div style="font-size: 0.9rem; color: #94a3b8;">–ü—É—Å—Ç–æ</div>
                    `;
                }
                
                slotsContainer.appendChild(slotDiv);
            });
        }

        function plantSeed() {
            if (game.coins < 10) {
                addEvent("‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ—Å–∞–¥–∫–∏!", "bad");
                return;
            }
            
            const seeds = game.inventory.find(item => item.type === 'seed' && item.quantity > 0);
            if (!seeds) {
                addEvent("‚ùå –ù–µ—Ç —Å–µ–º—è–Ω –¥–ª—è –ø–æ—Å–∞–¥–∫–∏!", "bad");
                return;
            }
            
            const emptySlotIndex = game.garden.slots.findIndex(slot => !slot.plant);
            if (emptySlotIndex === -1) {
                addEvent("‚ùå –ù–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –≤ —Å–∞–¥—É!", "bad");
                return;
            }
            
            game.coins -= 10;
            seeds.quantity--;
            if (seeds.quantity <= 0) {
                game.inventory = game.inventory.filter(i => i !== seeds);
            }
            
            const plantName = seeds.effect?.plant || "–ú–æ—Ä–∫–æ–≤—å";
            game.garden.slots[emptySlotIndex] = {
                plant: plantName,
                plantedAt: Date.now(),
                growth: 0
            };
            
            game.score += 5;
            addEvent(`üå± –ü–æ—Å–∞–∂–µ–Ω–∞ ${plantName} –≤ —Å–ª–æ—Ç ${emptySlotIndex + 1}!`, "good");
            updateDisplay();
            updateGarden();
            updateInventory();
        }

        function harvestSlot(index) {
            const slot = game.garden.slots[index];
            if (!slot || !slot.plant || slot.growth < 100) return;
            
            const plant = game.garden.plants.find(p => p.name === slot.plant);
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å —É—Ä–æ–∂–∞—è –æ—Ç –º—É—Ç–∞—Ü–∏–π
            const harvestMultiplier = game.mutations.reduce((mult, mutation) => 
                mult * (mutation.stats.harvest || 1), 1
            );
            
            // –°–±–æ—Ä —É—Ä–æ–∂–∞—è
            if (plant.yield.food) {
                const quantity = Math.round(plant.yield.food * harvestMultiplier);
                addToInventory({ 
                    name: plant.name, 
                    emoji: plant.emoji, 
                    type: "food", 
                    quantity,
                    effect: { hunger: plant.name === "–ú–æ—Ä–∫–æ–≤—å" ? 30 : plant.name === "–Ø–±–ª–æ–Ω—è" ? 50 : 70 }
                });
            }
            
            if (plant.yield.coins) {
                game.coins += plant.yield.coins;
            }
            
            if (plant.yield.mood) {
                game.pet.mood = Math.min(100, game.pet.mood + plant.yield.mood);
            }
            
            // –û—á–∏—Å—Ç–∫–∞ —Å–ª–æ—Ç–∞
            game.garden.slots[index] = { plant: null, plantedAt: 0, growth: 0 };
            
            game.score += 15 * harvestMultiplier;
            addEvent(`üåæ –°–æ–±—Ä–∞–Ω —É—Ä–æ–∂–∞–π ${plant.name}!`, "good");
            updateDisplay();
            updateGarden();
            updateInventory();
        }

        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
        function updateInventory() {
            const container = document.getElementById('inventory-items');
            container.innerHTML = '';
            
            if (game.inventory.length === 0) {
                container.innerHTML = '<div class="item-card empty"><div>üéí</div><div>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div></div>';
                return;
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Ç–∏–ø—É
            const grouped = {};
            game.inventory.forEach(item => {
                if (!grouped[item.type]) grouped[item.type] = [];
                grouped[item.type].push(item);
            });
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã
            Object.values(grouped).forEach(items => {
                items.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'item-card';
                    div.onclick = () => useInventoryItem(item);
                    
                    let effectText = '';
                    if (item.type === 'food') {
                        effectText = `+${item.effect?.hunger || 30} –≥–æ–ª–æ–¥`;
                    } else if (item.type === 'boost') {
                        effectText = item.name;
                    } else if (item.type === 'key') {
                        effectText = `–ö–ª—é—á ${item.rarity}`;
                    }
                    
                    div.innerHTML = `
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-name">${item.name}</div>
                        <div class="item-quantity">x${item.quantity}</div>
                        ${effectText ? `<div class="item-effect">${effectText}</div>` : ''}
                    `;
                    
                    container.appendChild(div);
                });
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª—é—á–∏
            Object.entries(game.keys).forEach(([type, quantity]) => {
                if (quantity > 0) {
                    const emoji = type === 'common' ? 'üîë' : type === 'rare' ? 'üîë' : 'üíé';
                    const name = type === 'common' ? '–û–±—ã—á–Ω—ã–π –∫–ª—é—á' : type === 'rare' ? '–†–µ–¥–∫–∏–π –∫–ª—é—á' : '–≠–ø–∏—á–µ—Å–∫–∏–π –∫–ª—é—á';
                    
                    const div = document.createElement('div');
                    div.className = 'item-card';
                    div.onclick = () => showCasesModal();
                    
                    div.innerHTML = `
                        <div class="item-emoji">${emoji}</div>
                        <div class="item-name">${name}</div>
                        <div class="item-quantity">x${quantity}</div>
                        <div class="item-effect">–î–ª—è –∫–µ–π—Å–æ–≤</div>
                    `;
                    
                    container.appendChild(div);
                }
            });
        }

        function useInventoryItem(item) {
            if (item.type === 'food') {
                feedPet();
            } else if (item.type === 'boost') {
                useBoostItem();
            } else if (item.type === 'heal') {
                item.quantity--;
                if (item.quantity <= 0) {
                    game.inventory = game.inventory.filter(i => i !== item);
                }
                
                game.pet.health = Math.min(game.pet.maxHealth, game.pet.health + 50);
                game.score += 10;
                addEvent("üß™ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ª–µ—á–µ–±–Ω–æ–µ –∑–µ–ª—å–µ! +50 –∑–¥–æ—Ä–æ–≤—å—è", "good");
                updateDisplay();
                updateInventory();
            } else if (item.type === 'key') {
                showCasesModal();
            }
        }

        function addToInventory(newItem) {
            const existing = game.inventory.find(item => 
                item.name === newItem.name && item.type === newItem.type
            );
            
            if (existing) {
                existing.quantity += newItem.quantity;
            } else {
                game.inventory.push(newItem);
            }
            
            updateInventory();
        }

        // –ú–∞–≥–∞–∑–∏–Ω
        function updateShop() {
            const container = document.getElementById('shop-items');
            container.innerHTML = '';
            
            game.shop.forEach(item => {
                const div = document.createElement('div');
                div.className = 'shop-item';
                
                div.innerHTML = `
                    <div class="shop-item-emoji">${item.emoji}</div>
                    <div class="shop-item-info">
                        <div class="shop-item-name">${item.name}</div>
                        <div class="shop-item-effect">${item.effect}</div>
                    </div>
                    <div class="shop-item-price">${item.price}üí∞</div>
                    <button class="buy-btn" onclick="buyShopItem(${item.id})" ${game.coins < item.price ? 'disabled' : ''}>
                        –ö—É–ø–∏—Ç—å
                    </button>
                `;
                
                container.appendChild(div);
            });
        }

        function buyShopItem(itemId) {
            const item = game.shop.find(i => i.id === itemId);
            if (!item || game.coins < item.price) return;
            
            game.coins -= item.price;
            game.score += 5;
            
            if (item.type === 'seed') {
                addToInventory({
                    id: Date.now(),
                    name: item.name,
                    emoji: item.emoji,
                    type: item.type,
                    quantity: 1,
                    effect: { plant: "–ú–æ—Ä–∫–æ–≤—å" }
                });
            } else if (item.type === 'food') {
                addToInventory({
                    id: Date.now(),
                    name: item.name,
                    emoji: item.emoji,
                    type: item.type,
                    quantity: 1,
                    effect: item.stats
                });
            } else if (item.type === 'boost' || item.type === 'heal') {
                addToInventory({
                    id: Date.now(),
                    name: item.name,
                    emoji: item.emoji,
                    type: item.type,
                    quantity: 1,
                    effect: item.stats
                });
            }
            
            addEvent(`üõí –ö—É–ø–ª–µ–Ω–æ: ${item.emoji} ${item.name}`, "good");
            updateDisplay();
            updateShop();
            updateInventory();
        }

        // –ë–æ–∏
        function updateBattleScreen() {
            const enemy = game.enemies[Math.floor(Math.random() * game.enemies.length)];
            
            document.getElementById('enemy-avatar').textContent = enemy.avatar;
            document.getElementById('enemy-name').textContent = enemy.name;
            document.getElementById('enemy-difficulty').textContent = 
                enemy.difficulty === 'easy' ? '–õ–µ–≥–∫–∏–π' : 
                enemy.difficulty === 'medium' ? '–°—Ä–µ–¥–Ω–∏–π' : '–°–ª–æ–∂–Ω—ã–π';
            document.getElementById('enemy-difficulty').className = 
                `opponent-difficulty difficulty-${enemy.difficulty}`;
            
            document.getElementById('reward-coins').textContent = 
                `${enemy.reward.coins[0]}-${enemy.reward.coins[1]}`;
            document.getElementById('reward-chance').textContent = 
                `${Math.round(enemy.reward.dropChance * 100)}%`;
            document.getElementById('reward-key').textContent = 
                `${Math.round(enemy.reward.keyChance * 100)}%`;
        }

        function startBattle() {
            const enemy = game.enemies.find(e => e.name === document.getElementById('enemy-name').textContent);
            if (!enemy) return;
            
            if (game.pet.health <= 0) {
                addEvent("‚ùå –ü–∏—Ç–æ–º–µ—Ü –±–µ–∑ —Å–æ–∑–Ω–∞–Ω–∏—è! –î–∞–π—Ç–µ –µ–º—É –æ—Ç–¥–æ—Ö–Ω—É—Ç—å.", "bad");
                return;
            }
            
            // –°–∏–º—É–ª—è—Ü–∏—è –±–æ—è —Å —É—á–µ—Ç–æ–º –±—É—Å—Ç–æ–≤
            const attackMultiplier = game.pet.boost.active ? game.pet.boost.multiplier : 1;
            const playerAttack = game.pet.attack * attackMultiplier;
            const playerDefense = game.pet.defense;
            
            let playerHealth = game.pet.health;
            let enemyHealth = enemy.health;
            let round = 1;
            let battleLog = [];
            
            // –°–∏–º—É–ª—è—Ü–∏—è 3-5 —Ä–∞—É–Ω–¥–æ–≤
            const rounds = Math.floor(Math.random() * 3) + 3;
            
            for (let i = 0; i < rounds; i++) {
                // –ò–≥—Ä–æ–∫ –∞—Ç–∞–∫—É–µ—Ç
                const playerDamage = Math.max(1, playerAttack * (0.7 + Math.random() * 0.6) - enemy.defense * 0.3);
                enemyHealth -= playerDamage;
                
                if (enemyHealth <= 0) break;
                
                // –í—Ä–∞–≥ –∞—Ç–∞–∫—É–µ—Ç
                const enemyDamage = Math.max(1, enemy.attack * (0.7 + Math.random() * 0.6) - playerDefense * 0.3);
                playerHealth -= enemyDamage;
                
                if (playerHealth <= 0) break;
            }
            
            const win = playerHealth > 0 && enemyHealth <= 0;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –ø–∏—Ç–æ–º—Ü–∞
            game.pet.health = Math.max(0, playerHealth);
            
            if (win) {
                // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –ø–æ–±–µ–¥—É
                const coinsReward = Math.floor(Math.random() * (enemy.reward.coins[1] - enemy.reward.coins[0] + 1)) + enemy.reward.coins[0];
                const expReward = enemy.reward.exp;
                
                game.coins += coinsReward;
                game.exp += expReward;
                game.score += enemy.reward.score;
                
                addEvent(`üéâ –ü–û–ë–ï–î–ê –Ω–∞–¥ ${enemy.name}! +${coinsReward} –º–æ–Ω–µ—Ç, +${expReward} –æ–ø—ã—Ç–∞`, "good");
                
                // –®–∞–Ω—Å –Ω–∞ –¥—Ä–æ–ø –ø—Ä–µ–¥–º–µ—Ç–∞
                if (Math.random() < enemy.reward.dropChance) {
                    const items = [
                        { name: "–ú–æ—Ä–∫–æ–≤—å", emoji: "ü•ï", type: "food", quantity: 2 },
                        { name: "–Ø–±–ª–æ–∫–æ", emoji: "üçé", type: "food", quantity: 1 },
                        { name: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫", emoji: "ü•§", type: "boost", quantity: 1 },
                        { name: "–õ–µ—á–µ–±–Ω–æ–µ –∑–µ–ª—å–µ", emoji: "üß™", type: "heal", quantity: 1 }
                    ];
                    
                    const droppedItem = items[Math.floor(Math.random() * items.length)];
                    addToInventory(droppedItem);
                    addEvent(`üéÅ –ü–æ–ª—É—á–µ–Ω –ø—Ä–µ–¥–º–µ—Ç: ${droppedItem.emoji} ${droppedItem.name}`, "good");
                }
                
                // –®–∞–Ω—Å –Ω–∞ –∫–ª—é—á
                if (Math.random() < enemy.reward.keyChance) {
                    const keyTypes = ['common', 'rare', 'epic'];
                    const weights = [0.7, 0.2, 0.1];
                    const random = Math.random();
                    let cumulative = 0;
                    let keyType = 'common';
                    
                    for (let i = 0; i < keyTypes.length; i++) {
                        cumulative += weights[i];
                        if (random < cumulative) {
                            keyType = keyTypes[i];
                            break;
                        }
                    }
                    
                    game.keys[keyType]++;
                    addEvent(`üîë –ü–æ–ª—É—á–µ–Ω ${keyType === 'common' ? '–æ–±—ã—á–Ω—ã–π' : keyType === 'rare' ? '—Ä–µ–¥–∫–∏–π' : '—ç–ø–∏—á–µ—Å–∫–∏–π'} –∫–ª—é—á!`, "good");
                }
            } else {
                game.score += Math.floor(enemy.reward.score * 0.3);
                addEvent(`üíÄ –ü–æ—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç ${enemy.name}...`, "bad");
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω—è
            if (game.exp >= game.expNeeded) {
                game.level++;
                game.pet.level++;
                game.exp = 0;
                game.expNeeded = game.level * 150;
                game.pet.maxHealth += 25;
                game.pet.health = game.pet.maxHealth;
                game.score += 50;
                
                addEvent(`üéâ –£—Ä–æ–≤–µ–Ω—å ${game.level}! –ó–¥–æ—Ä–æ–≤—å–µ +25`, "good");
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –±–æ—è
            updateBattleScreen();
            updateDisplay();
            updateInventory();
        }

        // –ö–µ–π—Å—ã
        function showCasesModal() {
            document.getElementById('cases-modal').style.display = 'flex';
        }

        function openCase(caseType) {
            const caseData = game.cases[caseType];
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞
            if (game.keys[caseData.requiredKey] <= 0) {
                addEvent(`‚ùå –ù—É–∂–µ–Ω ${caseData.requiredKey === 'common' ? '–æ–±—ã—á–Ω—ã–π' : caseData.requiredKey === 'rare' ? '—Ä–µ–¥–∫–∏–π' : '—ç–ø–∏—á–µ—Å–∫–∏–π'} –∫–ª—é—á!`, "bad");
                return;
            }
            
            // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞
            game.keys[caseData.requiredKey]--;
            
            // –í—ã–±–æ—Ä –Ω–∞–≥—Ä–∞–¥—ã
            const random = Math.random();
            let cumulative = 0;
            let reward = null;
            
            for (const r of caseData.rewards) {
                cumulative += r.chance;
                if (random < cumulative) {
                    reward = r;
                    break;
                }
            }
            
            if (!reward) reward = caseData.rewards[0];
            
            // –í—ã–¥–∞—á–∞ –Ω–∞–≥—Ä–∞–¥—ã
            if (reward.type === 'mutation') {
                addRandomMutation();
                addEvent(`üéÅ –û—Ç–∫—Ä—ã—Ç ${caseType} –∫–µ–π—Å! –ü–æ–ª—É—á–µ–Ω–∞ —Å–ª—É—á–∞–π–Ω–∞—è –º—É—Ç–∞—Ü–∏—è!`, "good");
            } else if (reward.type === 'special') {
                addToInventory({
                    name: reward.name,
                    emoji: reward.emoji,
                    type: "food",
                    quantity: reward.quantity,
                    effect: { hunger: 100, mood: 30, health: 50 }
                });
                addEvent(`üéÅ –û—Ç–∫—Ä—ã—Ç ${caseType} –∫–µ–π—Å! –ü–æ–ª—É—á–µ–Ω–æ: ${reward.emoji} ${reward.name} x${reward.quantity}`, "good");
            } else {
                addToInventory({
                    name: reward.name,
                    emoji: reward.emoji,
                    type: reward.type,
                    quantity: reward.quantity,
                    effect: reward.type === 'food' ? { hunger: 30 } : undefined
                });
                addEvent(`üéÅ –û—Ç–∫—Ä—ã—Ç ${caseType} –∫–µ–π—Å! –ü–æ–ª—É—á–µ–Ω–æ: ${reward.emoji} ${reward.name} x${reward.quantity}`, "good");
            }
            
            game.score += caseType === 'common' ? 25 : caseType === 'rare' ? 50 : 100;
            
            closeModal('cases-modal');
            updateDisplay();
            updateInventory();
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function endGame() {
            const finalScore = game.score;
            const timeBonus = Math.floor(game.level * 100 + game.coins * 0.5);
            const totalScore = finalScore + timeBonus;
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            
            modal.innerHTML = `
                <div class="modal-content">
                    <h2 class="modal-header">üèÅ –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
                    <div style="text-align: center; margin: 30px 0;">
                        <div style="font-size: 1.2rem; margin: 10px 0; color: #cbd5e1;">–í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</div>
                        <div style="font-size: 1.4rem; margin: 10px 0;">üèÜ –£—Ä–æ–≤–µ–Ω—å: ${game.level}</div>
                        <div style="font-size: 1.4rem; margin: 10px 0;">üí∞ –ú–æ–Ω–µ—Ç—ã: ${game.coins}</div>
                        <div style="font-size: 1.4rem; margin: 10px 0;">üß¨ –ú—É—Ç–∞—Ü–∏–∏: ${game.mutations.length}</div>
                        <div style="font-size: 1.4rem; margin: 10px 0;">üéØ –û—á–∫–∏: ${finalScore}</div>
                        <div style="font-size: 1.4rem; margin: 10px 0; color: #f59e0b;">‚≠ê –ë–æ–Ω—É—Å –∑–∞ –≤—Ä–µ–º—è: +${timeBonus}</div>
                        <div style="font-size: 2rem; margin: 20px 0; color: #f59e0b;">üèÖ –ò—Ç–æ–≥–æ–≤—ã–π —Å—á–µ—Ç: ${totalScore}</div>
                    </div>
                    <div style="text-align: center;">
                        <button class="buy-btn" onclick="location.reload()" style="width: 200px; padding: 15px; font-size: 1.2rem; background: linear-gradient(135deg, #7c3aed, #a78bfa);">
                            üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        window.onload = initGame;
    </script>
</body>
</html>
