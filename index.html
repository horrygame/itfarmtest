<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Вирусный менеджер - Заражение мира</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background-color: #1a1a2e;
            color: #e6e6e6;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #16213e;
            border-radius: 10px;
            border-bottom: 4px solid #0f3460;
        }
        
        h1 {
            font-size: 2.5rem;
            color: #e94560;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: #b8b8b8;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .game-layout {
            display: grid;
            grid-template-columns: 350px 1fr 350px;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1300px) {
            .game-layout {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 900px) {
            .game-layout {
                grid-template-columns: 1fr;
            }
        }
        
        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .center-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .panel {
            background-color: #16213e;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #0f3460;
        }
        
        .panel-title {
            font-size: 1.3rem;
            color: #e94560;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #0f3460;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .resources-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .resource {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .resource-icon {
            font-size: 2rem;
            color: #e94560;
            margin-bottom: 10px;
        }
        
        .resource-name {
            font-size: 0.9rem;
            color: #b8b8b8;
            margin-bottom: 5px;
        }
        
        .resource-amount {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffffff;
        }
        
        .clicker-area {
            text-align: center;
            padding: 20px 0;
        }
        
        .virus-cell {
            width: 140px;
            height: 140px;
            margin: 0 auto 15px;
            background: radial-gradient(circle, #e94560 0%, #b82e46 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.1s;
            user-select: none;
            border: 4px solid #ff6b8b;
            box-shadow: 0 0 20px rgba(233, 69, 96, 0.5);
        }
        
        .virus-cell:active {
            transform: scale(0.95);
        }
        
        .virus-icon {
            font-size: 3.5rem;
            color: #ffffff;
        }
        
        .click-info {
            margin-top: 10px;
            color: #b8b8b8;
        }
        
        .power-info {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .power-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #e94560;
            text-align: center;
            margin-bottom: 5px;
        }
        
        .power-label {
            text-align: center;
            color: #b8b8b8;
            font-size: 1rem;
        }
        
        .upgrades-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .upgrade {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid #e94560;
        }
        
        .upgrade:hover {
            background-color: #1a3a6e;
        }
        
        .upgrade.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .upgrade-name {
            font-size: 1.1rem;
            color: #ffffff;
            font-weight: bold;
        }
        
        .upgrade-cost {
            font-size: 1rem;
            color: #ffd166;
            font-weight: bold;
        }
        
        .upgrade-desc {
            font-size: 0.9rem;
            color: #b8b8b8;
            margin-bottom: 8px;
        }
        
        .upgrade-effect {
            font-size: 0.85rem;
            color: #4ecdc4;
            font-style: italic;
        }
        
        .upgrade-progress {
            height: 6px;
            background-color: #1a1a2e;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .upgrade-progress-bar {
            height: 100%;
            background-color: #e94560;
            border-radius: 3px;
            width: 0%;
            transition: width 0.5s;
        }
        
        /* Центральная панель - виды для заражения */
        .species-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .species-item {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
            min-height: 220px;
            display: flex;
            flex-direction: column;
        }
        
        .species-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .species-item.locked {
            opacity: 0.5;
            filter: grayscale(100%);
        }
        
        .species-item.infected {
            border-color: #e94560;
            background-color: rgba(233, 69, 96, 0.1);
        }
        
        .species-item.cured {
            border-color: #4ecdc4;
            background-color: rgba(78, 205, 196, 0.1);
        }
        
        .species-icon {
            font-size: 2.5rem;
            color: #e94560;
            margin-bottom: 10px;
        }
        
        .species-name {
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .species-desc {
            font-size: 0.8rem;
            color: #b8b8b8;
            margin-bottom: 10px;
        }
        
        .species-power {
            font-size: 0.9rem;
            color: #ffd166;
            margin-bottom: 10px;
        }
        
        .species-btn {
            padding: 8px 15px;
            background-color: #e94560;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.2s;
            margin-top: auto;
        }
        
        .species-btn:hover {
            background-color: #ff6b8b;
        }
        
        .species-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .species-btn.infecting {
            background-color: #4ecdc4;
        }
        
        .species-btn.curing {
            background-color: #4ecdc4;
        }
        
        .progress-container {
            margin-top: 10px;
        }
        
        .progress-label {
            font-size: 0.8rem;
            color: #b8b8b8;
            margin-bottom: 3px;
            display: flex;
            justify-content: space-between;
        }
        
        .progress-bar {
            height: 6px;
            background-color: #1a1a2e;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        
        .infection-progress-bar {
            height: 100%;
            background-color: #e94560;
            border-radius: 3px;
            width: 0%;
            transition: width 0.5s;
        }
        
        .cure-progress-bar {
            height: 100%;
            background-color: #4ecdc4;
            border-radius: 3px;
            width: 0%;
            transition: width 0.5s;
        }
        
        /* Правая панель - свойства вируса и эволюция */
        .properties-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .property {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
        }
        
        .property-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .property-name {
            font-weight: bold;
            color: #ffffff;
        }
        
        .property-value {
            color: #ffd166;
            font-weight: bold;
        }
        
        .property-desc {
            font-size: 0.85rem;
            color: #b8b8b8;
            margin-bottom: 10px;
        }
        
        .property-bar {
            height: 8px;
            background-color: #1a1a2e;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .property-bar-fill {
            height: 100%;
            background-color: #4ecdc4;
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s;
        }
        
        .evolution-section {
            margin-top: 20px;
        }
        
        .evolution-display {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .evolution-level {
            font-size: 1.8rem;
            font-weight: bold;
            color: #e94560;
            margin-bottom: 5px;
        }
        
        .evolution-name {
            color: #b8b8b8;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }
        
        .evolution-bar {
            height: 10px;
            background-color: #1a1a2e;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .evolution-bar-fill {
            height: 100%;
            background: linear-gradient(to right, #e94560, #ff6b8b);
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s;
        }
        
        .evolution-traits {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .evolution-trait {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .evolution-trait:hover {
            transform: translateY(-3px);
        }
        
        .evolution-trait.unlocked {
            border-color: #4ecdc4;
            background-color: rgba(78, 205, 196, 0.1);
        }
        
        .evolution-trait.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .trait-icon {
            font-size: 1.5rem;
            color: #e94560;
            margin-bottom: 5px;
        }
        
        .trait-name {
            font-weight: bold;
            color: #ffffff;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .trait-cost {
            font-size: 0.8rem;
            color: #ffd166;
        }
        
        .cure-section {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 2px solid #4ecdc4;
        }
        
        .cure-title {
            font-size: 1.2rem;
            color: #4ecdc4;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cure-stats {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .cure-stat {
            display: flex;
            justify-content: space-between;
        }
        
        .cure-stat-name {
            color: #b8b8b8;
            font-size: 0.9rem;
        }
        
        .cure-stat-value {
            color: #4ecdc4;
            font-weight: bold;
        }
        
        .cure-warning {
            background-color: rgba(233, 69, 96, 0.2);
            border-radius: 6px;
            padding: 10px;
            margin-top: 10px;
            font-size: 0.85rem;
            color: #e94560;
        }
        
        .stats-section {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #e94560;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #b8b8b8;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #16213e;
            color: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e94560;
            max-width: 300px;
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: #b8b8b8;
            font-size: 0.9rem;
            border-top: 2px solid #0f3460;
        }
        
        .section-title {
            font-size: 1.2rem;
            color: #e94560;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            border-bottom: 2px solid #0f3460;
            padding-bottom: 10px;
        }
        
        .tab {
            padding: 8px 16px;
            background-color: #0f3460;
            color: #e6e6e6;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .tab.active {
            background-color: #e94560;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .cure-resistance-bar {
            height: 8px;
            background-color: #1a1a2e;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .cure-resistance-fill {
            height: 100%;
            background-color: #4ecdc4;
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-virus"></i> Вирусный менеджер</h1>
            <p class="subtitle">Заражайте различные виды существ, развивайте свой вирус и боритесь с лечением!</p>
        </header>
        
        <div class="game-layout">
            <!-- Левая панель - ресурсы и управление -->
            <div class="left-panel">
                <div class="panel">
                    <h2 class="panel-title"><i class="fas fa-chart-bar"></i> Ресурсы</h2>
                    
                    <div class="resources-grid">
                        <div class="resource">
                            <div class="resource-icon"><i class="fas fa-dna"></i></div>
                            <div class="resource-name">Сила вируса</div>
                            <div class="resource-amount" id="virus-power">100</div>
                        </div>
                        
                        <div class="resource">
                            <div class="resource-icon"><i class="fas fa-bolt"></i></div>
                            <div class="resource-name">Энергия</div>
                            <div class="resource-amount" id="energy">50</div>
                        </div>
                        
                        <div class="resource">
                            <div class="resource-icon"><i class="fas fa-microscope"></i></div>
                            <div class="resource-name">Клетки</div>
                            <div class="resource-amount" id="cells">1</div>
                        </div>
                        
                        <div class="resource">
                            <div class="resource-icon"><i class="fas fa-star"></i></div>
                            <div class="resource-name">Очки эволюции</div>
                            <div class="resource-amount" id="evolution-points">0</div>
                        </div>
                    </div>
                    
                    <div class="clicker-area">
                        <div class="virus-cell" id="virus-cell">
                            <div class="virus-icon"><i class="fas fa-virus"></i></div>
                        </div>
                        <p class="click-info">Кликайте по вирусу, чтобы заражать клетки</p>
                        <p class="click-info">Каждый клик: <span id="click-power">1</span> силы, <span id="click-energy">0.5</span> энергии</p>
                    </div>
                    
                    <div class="power-info">
                        <div class="power-value" id="total-power">100</div>
                        <div class="power-label">Общая сила вируса</div>
                    </div>
                </div>
                
                <div class="panel">
                    <h2 class="panel-title"><i class="fas fa-cogs"></i> Улучшения вируса</h2>
                    
                    <div class="upgrades-list">
                        <div class="upgrade" id="upgrade1" onclick="buyUpgrade(1)">
                            <div class="upgrade-header">
                                <div class="upgrade-name">Острые шипы</div>
                                <div class="upgrade-cost">50 силы</div>
                            </div>
                            <div class="upgrade-desc">Улучшает способность вируса проникать в клетки</div>
                            <div class="upgrade-effect">Эффект: +2 силы за клик</div>
                            <div class="upgrade-progress">
                                <div class="upgrade-progress-bar" id="upgrade1-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="upgrade" id="upgrade2" onclick="buyUpgrade(2)">
                            <div class="upgrade-header">
                                <div class="upgrade-name">Авторепликация</div>
                                <div class="upgrade-cost">100 силы</div>
                            </div>
                            <div class="upgrade-desc">Вирус научился размножаться самостоятельно</div>
                            <div class="upgrade-effect">Эффект: Автозаражение 1 клетки/5сек</div>
                            <div class="upgrade-progress">
                                <div class="upgrade-progress-bar" id="upgrade2-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="upgrade" id="upgrade3" onclick="buyUpgrade(3)">
                            <div class="upgrade-header">
                                <div class="upgrade-name">Энергетическая оболочка</div>
                                <div class="upgrade-cost">80 энергии</div>
                            </div>
                            <div class="upgrade-desc">Повышает энергоэффективность вируса</div>
                            <div class="upgrade-effect">Эффект: +1 энергии за клик</div>
                            <div class="upgrade-progress">
                                <div class="upgrade-progress-bar" id="upgrade3-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="upgrade" id="upgrade4" onclick="buyUpgrade(4)">
                            <div class="upgrade-header">
                                <div class="upgrade-name">Устойчивость к лечению</div>
                                <div class="upgrade-cost">150 силы</div>
                            </div>
                            <div class="upgrade-desc">Защищает вирус от методов лечения</div>
                            <div class="upgrade-effect">Эффект: +10% сопротивления лечению</div>
                            <div class="upgrade-progress">
                                <div class="upgrade-progress-bar" id="upgrade4-bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Центральная панель - виды для заражения -->
            <div class="center-panel">
                <div class="panel">
                    <h2 class="panel-title"><i class="fas fa-globe-americas"></i> Мир для заражения</h2>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="land">Наземные</div>
                        <div class="tab" data-tab="air">Воздушные</div>
                        <div class="tab" data-tab="water">Водные</div>
                        <div class="tab" data-tab="special">Особые</div>
                    </div>
                    
                    <div class="tab-content active" id="land-tab">
                        <div class="species-grid" id="land-species">
                            <!-- Наземные виды будут добавлены через JavaScript -->
                        </div>
                    </div>
                    
                    <div class="tab-content" id="air-tab">
                        <div class="species-grid" id="air-species">
                            <!-- Воздушные виды будут добавлены через JavaScript -->
                        </div>
                    </div>
                    
                    <div class="tab-content" id="water-tab">
                        <div class="species-grid" id="water-species">
                            <!-- Водные виды будут добавлены через JavaScript -->
                        </div>
                    </div>
                    
                    <div class="tab-content" id="special-tab">
                        <div class="species-grid" id="special-species">
                            <!-- Особые виды будут добавлены через JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Правая панель - свойства вируса и эволюция -->
            <div class="right-panel">
                <div class="panel">
                    <h2 class="panel-title"><i class="fas fa-chart-pie"></i> Свойства вируса</h2>
                    
                    <div class="properties-list">
                        <div class="property">
                            <div class="property-header">
                                <div class="property-name">Заразность</div>
                                <div class="property-value" id="contagious-value">10%</div>
                            </div>
                            <div class="property-desc">Определяет скорость заражения новых видов</div>
                            <div class="property-bar">
                                <div class="property-bar-fill" id="contagious-bar" style="width: 10%"></div>
                            </div>
                        </div>
                        
                        <div class="property">
                            <div class="property-header">
                                <div class="property-name">Опасность</div>
                                <div class="property-value" id="danger-value">5%</div>
                            </div>
                            <div class="property-desc">Влияет на урон, который вирус наносит видам</div>
                            <div class="property-bar">
                                <div class="property-bar-fill" id="danger-bar" style="width: 5%"></div>
                            </div>
                        </div>
                        
                        <div class="property">
                            <div class="property-header">
                                <div class="property-name">Выживаемость</div>
                                <div class="property-value" id="survival-value">10%</div>
                            </div>
                            <div class="property-desc">Показывает устойчивость вируса к лечению</div>
                            <div class="property-bar">
                                <div class="property-bar-fill" id="survival-bar" style="width: 10%"></div>
                            </div>
                        </div>
                        
                        <div class="property">
                            <div class="property-header">
                                <div class="property-name">Скрытность</div>
                                <div class="property-value" id="stealth-value">5%</div>
                            </div>
                            <div class="property-desc">Определяет, насколько сложно обнаружить вирус</div>
                            <div class="property-bar">
                                <div class="property-bar-fill" id="stealth-bar" style="width: 5%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cure-section">
                        <div class="cure-title">
                            <i class="fas fa-shield-virus"></i> Сопротивление лечению
                        </div>
                        
                        <div class="cure-stats">
                            <div class="cure-stat">
                                <span class="cure-stat-name">Текущее сопротивление:</span>
                                <span class="cure-stat-value" id="cure-resistance-value">10%</span>
                            </div>
                            <div class="cure-resistance-bar">
                                <div class="cure-resistance-fill" id="cure-resistance-bar" style="width: 10%"></div>
                            </div>
                            
                            <div class="cure-stat">
                                <span class="cure-stat-name">Видов под лечением:</span>
                                <span class="cure-stat-value" id="species-under-cure">0</span>
                            </div>
                            
                            <div class="cure-stat">
                                <span class="cure-stat-name">Скорость лечения:</span>
                                <span class="cure-stat-value" id="cure-speed">0.1%/сек</span>
                            </div>
                            
                            <div class="cure-stat">
                                <span class="cure-stat-name">Излечившихся видов:</span>
                                <span class="cure-stat-value" id="cured-species">0</span>
                            </div>
                        </div>
                        
                        <div class="cure-warning">
                            <i class="fas fa-exclamation-triangle"></i> Виды могут излечиться! Повышайте сопротивление лечению.
                        </div>
                    </div>
                </div>
                
                <div class="panel">
                    <div class="evolution-section">
                        <div class="evolution-display">
                            <div class="evolution-level">Уровень <span id="evolution-level">1</span></div>
                            <div class="evolution-name" id="evolution-name">Обычный вирус</div>
                            <div>Прогресс до следующего уровня:</div>
                            <div class="evolution-bar">
                                <div class="evolution-bar-fill" id="evolution-progress-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="section-title"><i class="fas fa-dna"></i> Эволюционные черты</div>
                        
                        <div class="evolution-traits">
                            <div class="evolution-trait" id="trait1" onclick="buyTrait(1)">
                                <div class="trait-icon"><i class="fas fa-wind"></i></div>
                                <div class="trait-name">Воздушное заражение</div>
                                <div class="trait-cost">3 очка</div>
                            </div>
                            
                            <div class="evolution-trait" id="trait2" onclick="buyTrait(2)">
                                <div class="trait-icon"><i class="fas fa-shield-alt"></i></div>
                                <div class="trait-name">Иммунитет к лекарствам</div>
                                <div class="trait-cost">5 очков</div>
                            </div>
                            
                            <div class="evolution-trait" id="trait3" onclick="buyTrait(3)">
                                <div class="trait-icon"><i class="fas fa-eye-slash"></i></div>
                                <div class="trait-name">Невидимость</div>
                                <div class="trait-cost">4 очка</div>
                            </div>
                            
                            <div class="evolution-trait" id="trait4" onclick="buyTrait(4)">
                                <div class="trait-icon"><i class="fas fa-bolt"></i></div>
                                <div class="trait-name">Сверхбыстрая мутация</div>
                                <div class="trait-cost">6 очков</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-section">
                        <div class="stats-grid">
                            <div class="stat">
                                <div class="stat-value" id="total-infected">0</div>
                                <div class="stat-label">Всего заражено</div>
                            </div>
                            
                            <div class="stat">
                                <div class="stat-value" id="infected-species">0</div>
                                <div class="stat-label">Видов заражено</div>
                            </div>
                            
                            <div class="stat">
                                <div class="stat-value" id="auto-infect">0/сек</div>
                                <div class="stat-label">Скорость заражения</div>
                            </div>
                            
                            <div class="stat">
                                <div class="stat-value" id="total-power-display">100</div>
                                <div class="stat-label">Общая сила</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p><i class="fas fa-gamepad"></i> Вирусный менеджер - стратегическая игра о заражении мира. Развивайте вирус, заражайте виды и боритесь с лечением!</p>
        </div>
    </div>
    
    <div class="notification" id="notification">
        <div id="notification-text">Тестовое уведомление</div>
    </div>

    <script>
        // Игровые переменные
        let gameState = {
            virusPower: 100,
            energy: 50,
            cells: 1,
            evolutionPoints: 0,
            evolutionLevel: 1,
            evolutionProgress: 0,
            totalPower: 100,
            clickPower: 1,
            clickEnergy: 0.5,
            autoInfectRate: 0,
            totalInfected: 0,
            infectedSpeciesCount: 0,
            curedSpeciesCount: 0,
            cureResistance: 10,
            cureSpeed: 0.1,
            
            // Свойства вируса
            properties: {
                contagious: 10,   // Заразность
                danger: 5,        // Опасность
                survival: 10,     // Выживаемость
                stealth: 5        // Скрытность
            },
            
            // Улучшения
            upgrades: {
                1: { 
                    level: 0, 
                    maxLevel: 10, 
                    cost: 50, 
                    costMultiplier: 1.5, 
                    name: "Острые шипы", 
                    description: "Улучшает способность вируса проникать в клетки",
                    effect: "+2 силы за клик"
                },
                2: { 
                    level: 0, 
                    maxLevel: 5, 
                    cost: 100, 
                    costMultiplier: 2, 
                    name: "Авторепликация", 
                    description: "Вирус научился размножаться самостоятельно",
                    effect: "Автозаражение 1 клетки/5сек"
                },
                3: { 
                    level: 0, 
                    maxLevel: 8, 
                    cost: 80, 
                    costMultiplier: 1.8, 
                    name: "Энергетическая оболочка", 
                    description: "Повышает энергоэффективность вируса",
                    effect: "+1 энергии за клик"
                },
                4: { 
                    level: 0, 
                    maxLevel: 5, 
                    cost: 150, 
                    costMultiplier: 1.7, 
                    name: "Устойчивость к лечению", 
                    description: "Защищает вирус от методов лечения",
                    effect: "+10% сопротивления лечению"
                }
            },
            
            // Эволюционные черты
            traits: {
                1: { 
                    purchased: false, 
                    cost: 3, 
                    name: "Воздушное заражение", 
                    description: "Позволяет заражать воздушные виды",
                    effect: "Открывает доступ к воздушным видам"
                },
                2: { 
                    purchased: false, 
                    cost: 5, 
                    name: "Иммунитет к лекарствам", 
                    description: "Защищает от стандартных методов лечения",
                    effect: "+20% к сопротивлению лечению"
                },
                3: { 
                    purchased: false, 
                    cost: 4, 
                    name: "Невидимость", 
                    description: "Делает вирус невидимым для обнаружения",
                    effect: "+15% к скрытности, замедляет лечение"
                },
                4: { 
                    purchased: false, 
                    cost: 6, 
                    name: "Сверхбыстрая мутация", 
                    description: "Вирус мутирует с невероятной скоростью",
                    effect: "Увеличивает скорость эволюции на 30%"
                }
            },
            
            // Виды для заражения
            species: [
                // Наземные виды (land)
                { id: 1, name: "Мыши", category: "land", icon: "fa-mouse", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 50, reward: { power: 30, energy: 15 }, description: "Мелкие грызуны, легко заражаются", cureRate: 0.2 },
                { id: 2, name: "Кошки", category: "land", icon: "fa-cat", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 100, reward: { power: 50, energy: 25 }, description: "Домашние питомцы, умеренная сложность", cureRate: 0.15 },
                { id: 3, name: "Собаки", category: "land", icon: "fa-dog", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 150, reward: { power: 70, energy: 35 }, description: "Верные друзья человека", cureRate: 0.12 },
                { id: 4, name: "Коровы", category: "land", icon: "fa-cow", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 200, reward: { power: 100, energy: 50 }, description: "Крупный рогатый скот", cureRate: 0.1 },
                { id: 5, name: "Лошади", category: "land", icon: "fa-horse", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 250, reward: { power: 120, energy: 60 }, description: "Благородные животные", cureRate: 0.08 },
                { id: 6, name: "Медведи", category: "land", icon: "fa-paw", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 350, reward: { power: 150, energy: 75 }, description: "Крупные хищники", cureRate: 0.06 },
                { id: 7, name: "Слоны", category: "land", icon: "fa-otter", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 500, reward: { power: 200, energy: 100 }, description: "Гиганты животного мира", cureRate: 0.05 },
                
                // Воздушные виды (air) - требуют черту 1
                { id: 8, name: "Воробьи", category: "air", icon: "fa-dove", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 300, reward: { power: 130, energy: 65 }, description: "Мелкие птицы, обитают в городах", cureRate: 0.25 },
                { id: 9, name: "Голуби", category: "air", icon: "fa-dove", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 400, reward: { power: 160, energy: 80 }, description: "Городские птицы, разносчики", cureRate: 0.2 },
                { id: 10, name: "Орлы", category: "air", icon: "fa-dove", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 600, reward: { power: 250, energy: 125 }, description: "Короли неба, хищные птицы", cureRate: 0.1 },
                { id: 11, name: "Летучие мыши", category: "air", icon: "fa-kiwi-bird", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 450, reward: { power: 180, energy: 90 }, description: "Ночные летуны, переносчики", cureRate: 0.07 },
                
                // Водные виды (water) - требуют черту 2
                { id: 12, name: "Золотые рыбки", category: "water", icon: "fa-fish", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 250, reward: { power: 110, energy: 55 }, description: "Аквариумные рыбки, легкая добыча", cureRate: 0.3 },
                { id: 13, name: "Карпы", category: "water", icon: "fa-fish", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 350, reward: { power: 140, energy: 70 }, description: "Пресноводные рыбы, обитают в прудах", cureRate: 0.18 },
                { id: 14, name: "Акулы", category: "water", icon: "fa-fish", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 800, reward: { power: 350, energy: 175 }, description: "Морские хищники, опасные существа", cureRate: 0.04 },
                { id: 15, name: "Дельфины", category: "water", icon: "fa-fish", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 700, reward: { power: 300, energy: 150 }, description: "Умные морские млекопитающие", cureRate: 0.05 },
                
                // Особые виды (special) - требуют высокий уровень
                { id: 16, name: "Люди", category: "special", icon: "fa-user-friends", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 1000, reward: { power: 500, energy: 250, evolution: 1 }, description: "Вершина эволюции, самый сложный вид", cureRate: 0.03 },
                { id: 17, name: "Динозавры", category: "special", icon: "fa-dragon", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 1500, reward: { power: 800, energy: 400, evolution: 2 }, description: "Древние гиганты, вымершие виды", cureRate: 0.02 },
                { id: 18, name: "Мифические существа", category: "special", icon: "fa-dragon", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 2000, reward: { power: 1200, energy: 600, evolution: 3 }, description: "Легендарные создания из мифов", cureRate: 0.015 },
                { id: 19, name: "Инопланетяне", category: "special", icon: "fa-user-astronaut", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 3000, reward: { power: 2000, energy: 1000, evolution: 5 }, description: "Внеземные формы жизни", cureRate: 0.01 },
                { id: 20, name: "Боги", category: "special", icon: "fa-crown", infected: false, cured: false, infectionProgress: 0, cureProgress: 0, requiredPower: 5000, reward: { power: 5000, energy: 2500, evolution: 10 }, description: "Верховные существа, конечная цель", cureRate: 0.005 }
            ],
            
            // Активное заражение
            activeInfections: []
        };

        // DOM элементы
        const virusPowerEl = document.getElementById('virus-power');
        const energyEl = document.getElementById('energy');
        const cellsEl = document.getElementById('cells');
        const evolutionPointsEl = document.getElementById('evolution-points');
        const clickPowerEl = document.getElementById('click-power');
        const clickEnergyEl = document.getElementById('click-energy');
        const totalPowerEl = document.getElementById('total-power');
        const totalPowerDisplayEl = document.getElementById('total-power-display');
        const virusCellEl = document.getElementById('virus-cell');
        const notificationEl = document.getElementById('notification');
        const notificationTextEl = document.getElementById('notification-text');
        const totalInfectedEl = document.getElementById('total-infected');
        const infectedSpeciesEl = document.getElementById('infected-species');
        const autoInfectEl = document.getElementById('auto-infect');
        const contagiousValueEl = document.getElementById('contagious-value');
        const dangerValueEl = document.getElementById('danger-value');
        const survivalValueEl = document.getElementById('survival-value');
        const stealthValueEl = document.getElementById('stealth-value');
        const evolutionLevelEl = document.getElementById('evolution-level');
        const evolutionNameEl = document.getElementById('evolution-name');
        const evolutionProgressBar = document.getElementById('evolution-progress-bar');
        const cureResistanceValueEl = document.getElementById('cure-resistance-value');
        const cureResistanceBar = document.getElementById('cure-resistance-bar');
        const speciesUnderCureEl = document.getElementById('species-under-cure');
        const cureSpeedEl = document.getElementById('cure-speed');
        const curedSpeciesEl = document.getElementById('cured-species');
        const landSpeciesEl = document.getElementById('land-species');
        const airSpeciesEl = document.getElementById('air-species');
        const waterSpeciesEl = document.getElementById('water-species');
        const specialSpeciesEl = document.getElementById('special-species');

        // Инициализация игры
        function initGame() {
            updateUI();
            renderSpecies();
            setupEventListeners();
            
            // Запуск игрового цикла
            setInterval(gameLoop, 1000);
            
            showNotification("Добро пожаловать в Вирусный менеджер! Кликайте по вирусу, чтобы увеличивать его силу.");
        }

        // Игровой цикл
        function gameLoop() {
            // Автоматическое заражение клеток
            if (gameState.autoInfectRate > 0) {
                const cellsToInfect = gameState.autoInfectRate;
                gameState.cells += cellsToInfect;
                gameState.virusPower += cellsToInfect * gameState.clickPower;
                gameState.energy += cellsToInfect * gameState.clickEnergy;
                gameState.totalInfected += cellsToInfect;
            }
            
            // Обработка активных заражений
            processInfections();
            
            // Обработка лечения видов
            processCuring();
            
            // Обновление прогресса эволюции
            updateEvolution();
            
            updateUI();
        }

        // Обработка активных заражений видов
        function processInfections() {
            for (let i = gameState.activeInfections.length - 1; i >= 0; i--) {
                const infection = gameState.activeInfections[i];
                const species = gameState.species.find(s => s.id === infection.speciesId);
                
                if (!species) {
                    gameState.activeInfections.splice(i, 1);
                    continue;
                }
                
                // Расчет скорости заражения на основе свойств вируса
                const infectionRate = gameState.properties.contagious / 100;
                species.infectionProgress += infectionRate;
                
                // Если заражение завершено
                if (species.infectionProgress >= 100) {
                    completeInfection(species.id);
                    gameState.activeInfections.splice(i, 1);
                }
            }
        }

        // Обработка лечения видов
        function processCuring() {
            let speciesUnderCure = 0;
            let totalCureSpeed = 0;
            
            gameState.species.forEach(species => {
                if (species.infected && !species.cured && species.infectionProgress >= 100) {
                    speciesUnderCure++;
                    
                    // Базовая скорость лечения вида
                    let speciesCureRate = species.cureRate;
                    
                    // Уменьшение скорости лечения в зависимости от сопротивления вируса
                    speciesCureRate *= (100 - gameState.cureResistance) / 100;
                    
                    // Учет черты "Невидимость"
                    if (gameState.traits[3].purchased) {
                        speciesCureRate *= 0.7; // Уменьшаем лечение на 30%
                    }
                    
                    // Применение лечения
                    species.cureProgress += speciesCureRate;
                    totalCureSpeed += speciesCureRate;
                    
                    // Если лечение завершено
                    if (species.cureProgress >= 100) {
                        cureSpecies(species.id);
                    }
                }
            });
            
            gameState.cureSpeed = totalCureSpeed;
        }

        // Завершение заражения вида
        function completeInfection(speciesId) {
            const species = gameState.species.find(s => s.id === speciesId);
            
            if (!species || species.infected) return;
            
            // Отмечаем вид как зараженный
            species.infected = true;
            species.infectionProgress = 100;
            gameState.infectedSpeciesCount++;
            
            // Награда за заражение
            gameState.virusPower += species.reward.power;
            gameState.energy += species.reward.energy;
            
            if (species.reward.evolution) {
                gameState.evolutionPoints += species.reward.evolution;
            }
            
            // Увеличиваем общую силу
            gameState.totalPower += species.reward.power;
            
            showNotification(`Вид "${species.name}" полностью заражен! +${species.reward.power} силы, +${species.reward.energy} энергии`);
            
            // Обновление свойств вируса на основе зараженных видов
            updateVirusProperties();
        }

        // Лечение вида
        function cureSpecies(speciesId) {
            const species = gameState.species.find(s => s.id === speciesId);
            
            if (!species || species.cured) return;
            
            // Отмечаем вид как излеченный
            species.cured = true;
            species.infectionProgress = 0;
            species.cureProgress = 0;
            gameState.infectedSpeciesCount--;
            gameState.curedSpeciesCount++;
            
            // Штраф за излечение
            const penalty = Math.floor(species.reward.power * 0.5);
            gameState.virusPower = Math.max(0, gameState.virusPower - penalty);
            gameState.totalPower = Math.max(0, gameState.totalPower - penalty);
            
            showNotification(`Вид "${species.name}" излечился от вируса! Потеряно ${penalty} силы вируса.`);
            
            // Обновление свойств вируса
            updateVirusProperties();
        }

        // Обновление свойств вируса
        function updateVirusProperties() {
            // Базовые значения
            let contagious = 10;
            let danger = 5;
            let survival = 10;
            let stealth = 5;
            
            // Влияние уровня эволюции
            contagious += gameState.evolutionLevel * 3;
            danger += gameState.evolutionLevel * 2;
            survival += gameState.evolutionLevel * 2;
            stealth += gameState.evolutionLevel * 1;
            
            // Влияние черт эволюции
            if (gameState.traits[2].purchased) {
                gameState.cureResistance += 20;
            }
            if (gameState.traits[3].purchased) stealth += 15;
            
            // Влияние зараженных видов
            const infectedCount = gameState.infectedSpeciesCount;
            contagious += infectedCount * 2;
            danger += infectedCount * 1;
            survival += infectedCount * 1;
            
            // Ограничение максимум 100%
            gameState.properties.contagious = Math.min(100, contagious);
            gameState.properties.danger = Math.min(100, danger);
            gameState.properties.survival = Math.min(100, survival);
            gameState.properties.stealth = Math.min(100, stealth);
            
            // Ограничение сопротивления лечению
            gameState.cureResistance = Math.min(95, gameState.cureResistance);
        }

        // Обновление эволюции
        function updateEvolution() {
            // Прогресс эволюции зависит от зараженных видов и общей силы
            const baseProgress = gameState.infectedSpeciesCount * 5 + gameState.totalPower / 100;
            
            // Множитель от черты
            let progressMultiplier = 1;
            if (gameState.traits[4].purchased) {
                progressMultiplier = 1.3;
            }
            
            gameState.evolutionProgress += baseProgress * progressMultiplier / 100;
            
            // Если прогресс достиг 100%, повышаем уровень эволюции
            if (gameState.evolutionProgress >= 100) {
                gameState.evolutionLevel++;
                gameState.evolutionProgress = 0;
                gameState.evolutionPoints++;
                
                // Обновление имени вируса в зависимости от уровня
                const virusNames = [
                    "Обычный вирус", "Усиленный вирус", "Опасный вирус", 
                    "Угрожающий вирус", "Эпидемический вирус", "Пандемический вирус",
                    "Апокалиптический вирус", "Легендарный вирус", "Мифический вирус", "Божественный вирус"
                ];
                
                const nameIndex = Math.min(virusNames.length - 1, gameState.evolutionLevel - 1);
                const virusName = virusNames[nameIndex];
                
                showNotification(`Вирус эволюционировал до уровня ${gameState.evolutionLevel}: ${virusName}! Получено 1 очко эволюции.`);
            }
        }

        // Обновление интерфейса
        function updateUI() {
            // Обновление ресурсов
            virusPowerEl.textContent = Math.floor(gameState.virusPower);
            energyEl.textContent = Math.floor(gameState.energy);
            cellsEl.textContent = Math.floor(gameState.cells);
            evolutionPointsEl.textContent = gameState.evolutionPoints;
            
            // Обновление мощности клика
            clickPowerEl.textContent = gameState.clickPower;
            clickEnergyEl.textContent = gameState.clickEnergy.toFixed(1);
            
            // Обновление общей силы
            totalPowerEl.textContent = Math.floor(gameState.totalPower);
            totalPowerDisplayEl.textContent = Math.floor(gameState.totalPower);
            
            // Обновление статистики
            totalInfectedEl.textContent = Math.floor(gameState.totalInfected);
            infectedSpeciesEl.textContent = gameState.infectedSpeciesCount;
            autoInfectEl.textContent = gameState.autoInfectRate.toFixed(1) + "/сек";
            
            // Обновление свойств вируса
            contagiousValueEl.textContent = Math.floor(gameState.properties.contagious) + "%";
            dangerValueEl.textContent = Math.floor(gameState.properties.danger) + "%";
            survivalValueEl.textContent = Math.floor(gameState.properties.survival) + "%";
            stealthValueEl.textContent = Math.floor(gameState.properties.stealth) + "%";
            
            // Обновление баров свойств
            document.getElementById('contagious-bar').style.width = gameState.properties.contagious + "%";
            document.getElementById('danger-bar').style.width = gameState.properties.danger + "%";
            document.getElementById('survival-bar').style.width = gameState.properties.survival + "%";
            document.getElementById('stealth-bar').style.width = gameState.properties.stealth + "%";
            
            // Обновление эволюции
            evolutionLevelEl.textContent = gameState.evolutionLevel;
            
            // Обновление имени вируса
            const virusNames = [
                "Обычный вирус", "Усиленный вирус", "Опасный вирус", 
                "Угрожающий вирус", "Эпидемический вирус", "Пандемический вирус",
                "Апокалиптический вирус", "Легендарный вирус", "Мифический вирус", "Божественный вирус"
            ];
            
            const nameIndex = Math.min(virusNames.length - 1, gameState.evolutionLevel - 1);
            evolutionNameEl.textContent = virusNames[nameIndex];
            
            // Обновление прогресса эволюции
            evolutionProgressBar.style.width = gameState.evolutionProgress + "%";
            
            // Обновление статистики лечения
            cureResistanceValueEl.textContent = Math.floor(gameState.cureResistance) + "%";
            cureResistanceBar.style.width = gameState.cureResistance + "%";
            
            // Подсчет видов под лечением
            const speciesUnderCure = gameState.species.filter(s => s.infected && !s.cured && s.infectionProgress >= 100).length;
            speciesUnderCureEl.textContent = speciesUnderCure;
            
            cureSpeedEl.textContent = gameState.cureSpeed.toFixed(2) + "%/сек";
            curedSpeciesEl.textContent = gameState.curedSpeciesCount;
            
            // Обновление улучшений
            updateUpgradesUI();
            
            // Обновление видов
            renderSpecies();
        }

        // Обновление улучшений
        function updateUpgradesUI() {
            for (let i = 1; i <= 4; i++) {
                const upgrade = gameState.upgrades[i];
                const upgradeEl = document.getElementById(`upgrade${i}`);
                const costEl = upgradeEl.querySelector('.upgrade-cost');
                const progressBar = document.getElementById(`upgrade${i}-bar`);
                
                // Расчет текущей стоимости
                const currentCost = Math.floor(upgrade.cost * Math.pow(upgrade.costMultiplier, upgrade.level));
                
                // Обновление стоимости
                if (i === 3) {
                    costEl.textContent = `${currentCost} энергии`;
                } else {
                    costEl.textContent = `${currentCost} силы`;
                }
                
                // Обновление прогресса
                progressBar.style.width = `${(upgrade.level / upgrade.maxLevel) * 100}%`;
                
                // Проверка возможности покупки
                if ((i === 3 && gameState.energy >= currentCost) || (i !== 3 && gameState.virusPower >= currentCost)) {
                    upgradeEl.classList.remove('disabled');
                } else {
                    upgradeEl.classList.add('disabled');
                }
            }
            
            // Обновление черт эволюции
            for (let i = 1; i <= 4; i++) {
                const trait = gameState.traits[i];
                const traitEl = document.getElementById(`trait${i}`);
                
                if (trait.purchased) {
                    traitEl.classList.add('unlocked');
                    traitEl.classList.remove('disabled');
                } else {
                    // Проверка возможности покупки
                    if (gameState.evolutionPoints >= trait.cost) {
                        traitEl.classList.remove('disabled');
                    } else {
                        traitEl.classList.add('disabled');
                    }
                }
            }
        }

        // Покупка улучшения
        function buyUpgrade(upgradeId) {
            const upgrade = gameState.upgrades[upgradeId];
            const currentCost = Math.floor(upgrade.cost * Math.pow(upgrade.costMultiplier, upgrade.level));
            
            // Проверка максимального уровня
            if (upgrade.level >= upgrade.maxLevel) {
                showNotification(`Улучшение "${upgrade.name}" достигло максимального уровня!`);
                return;
            }
            
            // Проверка ресурсов
            if (upgradeId === 3) {
                // Улучшение за энергию
                if (gameState.energy < currentCost) {
                    showNotification(`Недостаточно энергии! Нужно ${currentCost} энергии.`);
                    return;
                }
                gameState.energy -= currentCost;
            } else {
                // Улучшение за силу
                if (gameState.virusPower < currentCost) {
                    showNotification(`Недостаточно силы вируса! Нужно ${currentCost} силы.`);
                    return;
                }
                gameState.virusPower -= currentCost;
            }
            
            // Применение улучшения
            upgrade.level++;
            
            if (upgradeId === 1) {
                gameState.clickPower += 2;
                showNotification(`Улучшение "${upgrade.name}" куплено! Теперь вы получаете +${gameState.clickPower} силы за клик.`);
            } else if (upgradeId === 2) {
                gameState.autoInfectRate += 0.2;
                showNotification(`Улучшение "${upgrade.name}" куплено! Автозаражение: ${gameState.autoInfectRate.toFixed(1)} клеток/сек.`);
            } else if (upgradeId === 3) {
                gameState.clickEnergy += 0.5;
                showNotification(`Улучшение "${upgrade.name}" куплено! Теперь вы получаете +${gameState.clickEnergy.toFixed(1)} энергии за клик.`);
            } else if (upgradeId === 4) {
                gameState.cureResistance += 10;
                showNotification(`Улучшение "${upgrade.name}" куплено! +10% сопротивления лечению.`);
            }
            
            updateVirusProperties();
            updateUI();
        }

        // Покупка черты эволюции
        function buyTrait(traitId) {
            const trait = gameState.traits[traitId];
            
            // Проверка, куплена ли уже черта
            if (trait.purchased) {
                showNotification(`Черта "${trait.name}" уже приобретена!`);
                return;
            }
            
            // Проверка ресурсов
            if (gameState.evolutionPoints < trait.cost) {
                showNotification(`Недостаточно очков эволюции! Нужно ${trait.cost}.`);
                return;
            }
            
            // Списание ресурсов
            gameState.evolutionPoints -= trait.cost;
            
            // Применение черты
            trait.purchased = true;
            
            showNotification(`Черта "${trait.name}" приобретена! ${trait.effect}`);
            
            updateVirusProperties();
            updateUI();
        }

        // Обработка клика по вирусу
        function handleVirusClick() {
            // Анимация клика
            virusCellEl.style.transform = 'scale(0.95)';
            setTimeout(() => {
                virusCellEl.style.transform = 'scale(1)';
            }, 100);
            
            // Начисление ресурсов
            gameState.virusPower += gameState.clickPower;
            gameState.energy += gameState.clickEnergy;
            gameState.cells += 0.1;
            gameState.totalInfected += 0.1;
            gameState.totalPower += gameState.clickPower;
            
            // Случайный бонус
            if (Math.random() < 0.1) {
                const bonus = Math.floor(Math.random() * 20) + 5;
                gameState.virusPower += bonus;
                gameState.totalPower += bonus;
                showNotification(`Критическая мутация! +${bonus} силы вируса`);
            }
            
            updateUI();
        }

        // Рендер видов
        function renderSpecies() {
            // Очистка контейнеров
            landSpeciesEl.innerHTML = '';
            airSpeciesEl.innerHTML = '';
            waterSpeciesEl.innerHTML = '';
            specialSpeciesEl.innerHTML = '';
            
            // Сортировка видов по категориям
            gameState.species.forEach(species => {
                const speciesEl = document.createElement('div');
                
                // Определяем, заблокирован ли вид
                let isLocked = false;
                let lockReason = "";
                
                if (species.category === "air" && !gameState.traits[1].purchased) {
                    isLocked = true;
                    lockReason = "Требуется черта 'Воздушное заражение'";
                }
                
                if (species.category === "water" && gameState.evolutionLevel < 3) {
                    isLocked = true;
                    lockReason = "Требуется 3 уровень эволюции";
                }
                
                if (species.category === "special" && gameState.evolutionLevel < 5) {
                    isLocked = true;
                    lockReason = "Требуется 5 уровень эволюции";
                }
                
                if (species.requiredPower > gameState.totalPower) {
                    isLocked = true;
                    lockReason = `Требуется ${species.requiredPower} силы вируса`;
                }
                
                // Проверяем, заражается ли вид в данный момент
                const isInfecting = gameState.activeInfections.some(inf => inf.speciesId === species.id);
                
                let statusClass = '';
                if (species.cured) {
                    statusClass = 'cured';
                } else if (species.infected) {
                    statusClass = 'infected';
                }
                
                speciesEl.className = `species-item ${statusClass} ${isLocked ? 'locked' : ''}`;
                speciesEl.innerHTML = `
                    <div class="species-icon"><i class="fas ${species.icon}"></i></div>
                    <div class="species-name">${species.name}</div>
                    <div class="species-desc">${species.description}</div>
                    <div class="species-power">Требуется: ${species.requiredPower} силы</div>
                    ${isLocked ? 
                        `<div style="color: #ff6b8b; font-size: 0.8rem; margin-bottom: 10px;">${lockReason}</div>` : 
                        ''
                    }
                    ${species.cured ? 
                        `<div style="color: #4ecdc4; font-weight: bold; margin-top: auto;">ИЗЛЕЧЕН</div>` :
                    species.infected ? 
                        `<div style="color: #e94560; font-weight: bold; margin-top: auto;">ЗАРАЖЕН</div>` :
                    isInfecting ?
                        `<button class="species-btn infecting" disabled>Заражается... ${species.infectionProgress.toFixed(0)}%</button>` :
                        `<button class="species-btn" onclick="startInfection(${species.id})" ${isLocked ? 'disabled' : ''}>Заразить</button>`
                    }
                    ${!species.cured && !isLocked ? 
                        `<div class="progress-container">
                            <div class="progress-label">
                                <span>Заражение</span>
                                <span>${species.infectionProgress.toFixed(0)}%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="infection-progress-bar" style="width: ${species.infectionProgress}%"></div>
                            </div>
                            ${species.infected && species.infectionProgress >= 100 ? 
                                `<div class="progress-label">
                                    <span>Лечение</span>
                                    <span>${species.cureProgress.toFixed(0)}%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="cure-progress-bar" style="width: ${species.cureProgress}%"></div>
                                </div>` : 
                                ''
                            }
                        </div>` : 
                        ''
                    }
                `;
                
                // Добавляем вид в соответствующий контейнер
                if (species.category === "land") landSpeciesEl.appendChild(speciesEl);
                if (species.category === "air") airSpeciesEl.appendChild(speciesEl);
                if (species.category === "water") waterSpeciesEl.appendChild(speciesEl);
                if (species.category === "special") specialSpeciesEl.appendChild(speciesEl);
            });
        }

        // Начало заражения вида
        function startInfection(speciesId) {
            const species = gameState.species.find(s => s.id === speciesId);
            
            if (!species || species.infected || species.cured) return;
            
            // Проверка, не заражается ли уже этот вид
            if (gameState.activeInfections.some(inf => inf.speciesId === speciesId)) {
                return;
            }
            
            // Проверка требований
            if (gameState.totalPower < species.requiredPower) {
                showNotification(`Недостаточно силы вируса! Требуется ${species.requiredPower} силы.`);
                return;
            }
            
            // Проверка специальных требований
            if (species.category === "air" && !gameState.traits[1].purchased) {
                showNotification(`Для заражения воздушных видов требуется черта "Воздушное заражение"!`);
                return;
            }
            
            if (species.category === "water" && gameState.evolutionLevel < 3) {
                showNotification(`Для заражения водных видов требуется 3 уровень эволюции!`);
                return;
            }
            
            if (species.category === "special" && gameState.evolutionLevel < 5) {
                showNotification(`Для заражения особых видов требуется 5 уровень эволюции!`);
                return;
            }
            
            // Добавление в активные заражения
            gameState.activeInfections.push({
                speciesId: speciesId,
                startTime: Date.now()
            });
            
            showNotification(`Начато заражение вида "${species.name}"!`);
            
            updateUI();
        }

        // Показать уведомление
        function showNotification(text) {
            notificationTextEl.textContent = text;
            notificationEl.classList.add('show');
            
            setTimeout(() => {
                notificationEl.classList.remove('show');
            }, 3000);
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            virusCellEl.addEventListener('click', handleVirusClick);
            
            // Табы
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Убрать активный класс со всех табов и контента
                    tabs.forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Добавить активный класс текущему табу и контенту
                    tab.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }

        // Запуск игры при загрузке страницы
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
